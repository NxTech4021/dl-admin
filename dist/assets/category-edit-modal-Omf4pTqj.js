import{r as i,k as x,l as L,j as e,N as I,P as M,Q as F,R as O,a1 as P,V as le,h as d,a2 as _,a3 as T,a4 as R,a5 as se,a6 as oe,I as k,au as ie,av as te,B as G,ce as ne,aw as me,d as X,cf as re,J as B,K as de,Z as ce,X as ue,t as w}from"./index-DZtjoQ1a.js";const ge=[{value:"SINGLES",label:"Singles"},{value:"DOUBLES",label:"Doubles"}],Ne=t=>{switch(t==null?void 0:t.toUpperCase()){case"PADEL":return"default";case"PICKLEBALL":return"secondary";case"TENNIS":return"outline";default:return"outline"}};function he({open:t,onOpenChange:W,categoryId:c,onCategoryUpdated:b}){const[p,v]=i.useState(!1),[$,E]=i.useState(!1),[A,u]=i.useState(""),[g,N]=i.useState([]),[H,U]=i.useState(!1),[j,K]=i.useState(!1),[D,Y]=i.useState(""),h=i.useRef(null),[De,V]=i.useState(null),[s,n]=i.useState({name:"",matchFormat:"",game_type:"SINGLES",gender_category:"MALE",genderRestriction:"OPEN",maxPlayers:null,maxTeams:null,categoryOrder:0,leagueIds:[],isActive:!0}),S=i.useCallback((a,l)=>{let o;return a==="MIXED"?o="Mixed":a==="MALE"?o="Men's":a==="FEMALE"?o="Women's":o=`${a.charAt(0)}${a.slice(1).toLowerCase()}'s`,`${o} ${l==="SINGLES"?"Singles":"Doubles"}`},[]),q=a=>{n(l=>({...l,game_type:a,name:S(l.gender_category,a)}))},z=a=>{n(l=>({...l,gender_category:a,name:S(a,l.game_type)}))},J=a=>{n(l=>({...l,leagueIds:l.leagueIds.includes(a)?l.leagueIds.filter(o=>o!==a):[...l.leagueIds,a]}))},Q=a=>{n(l=>({...l,leagueIds:l.leagueIds.filter(o=>o!==a)}))},y=i.useMemo(()=>g.filter(a=>s.leagueIds.includes(a.id)),[g,s.leagueIds]),C=i.useMemo(()=>g.filter(a=>a.name.toLowerCase().includes(D.toLowerCase())),[g,D]);i.useEffect(()=>{t&&c&&(E(!0),x.get(L.categories.getById(c)).then(a=>{var o,m;const l=(o=a.data)==null?void 0:o.data;if(l){V(l);let r="MIXED";l.genderRestriction==="MALE"?r="MEN":l.genderRestriction==="FEMALE"?r="WOMEN":(l.genderRestriction==="MIXED"||l.genderRestriction==="OPEN")&&(r="MIXED"),n({name:l.name||"",matchFormat:l.matchFormat||"",game_type:l.game_type||"SINGLES",gender_category:r,genderRestriction:l.genderRestriction||"OPEN",maxPlayers:l.maxPlayers||null,maxTeams:l.maxTeams||null,categoryOrder:l.categoryOrder||0,leagueIds:((m=l.leagues)==null?void 0:m.map(ae=>ae.id))||[],isActive:l.isActive??!0})}}).catch(a=>{console.error("Error fetching category:",a),u("Failed to load category data")}),U(!0),x.get(L.league.getAll).then(a=>{var o;const l=(o=a.data)==null?void 0:o.data;console.log("Leagues API response:",a.data),l!=null&&l.leagues&&Array.isArray(l.leagues)?N(l.leagues):Array.isArray(l)?N(l):(console.warn("Leagues data is not an array:",l),N([]))}).catch(a=>{console.error("Error fetching leagues:",a),N([])}).finally(()=>{U(!1),E(!1)}))},[t,c]);const Z=()=>{n({name:"",matchFormat:"",game_type:"SINGLES",gender_category:"MALE",genderRestriction:"OPEN",maxPlayers:null,maxTeams:null,categoryOrder:0,leagueIds:[],isActive:!0}),u(""),V(null)},f=()=>{Z(),W(!1)},ee=async()=>{var a,l;if(!s.name||!s.matchFormat||s.leagueIds.length===0){w.error("Please fill in all required fields");return}v(!0),u("");try{const o=s.gender_category==="MEN"?"MALE":s.gender_category==="WOMEN"?"FEMALE":s.gender_category==="MIXED"?"MIXED":"OPEN",m={name:s.name,genderRestriction:o,matchFormat:s.matchFormat,game_type:s.game_type,gender_category:s.gender_category,categoryOrder:s.categoryOrder,leagueIds:s.leagueIds,isActive:s.isActive};if((await x.put(L.categories.update(c),m)).status===200)w.success("Category updated successfully!"),f(),b&&await b();else throw new Error("Failed to update category")}catch(o){console.error("Error updating category:",o);const m=((l=(a=o.response)==null?void 0:a.data)==null?void 0:l.message)||o.message||"Failed to update category";u(m),w.error(m)}finally{v(!1)}};return $?e.jsxDEV(I,{open:t,onOpenChange:f,children:e.jsxDEV(M,{className:"max-w-2xl",children:[e.jsxDEV(F,{children:e.jsxDEV(O,{children:"Loading"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:364,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:363,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center justify-center py-8",children:[e.jsxDEV(P,{className:"h-8 w-8 animate-spin"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:367,columnNumber:13},this),e.jsxDEV("span",{className:"ml-2",children:"Loading category data..."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:368,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:366,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:362,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:361,columnNumber:7},this):e.jsxDEV(I,{open:t,onOpenChange:f,children:e.jsxDEV(M,{className:"sm:max-w-lg",children:[e.jsxDEV(F,{children:[e.jsxDEV(O,{children:"Edit Category"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:379,columnNumber:11},this),e.jsxDEV(le,{children:"Update the tournament category with specific settings and league assignments."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:380,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:378,columnNumber:9},this),A&&e.jsxDEV("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-3",children:e.jsxDEV("p",{className:"text-sm text-destructive",children:A},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:388,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:387,columnNumber:11},this),e.jsxDEV("div",{className:"grid gap-6",children:[e.jsxDEV("div",{className:"rounded-lg border bg-card p-4 text-card-foreground shadow-sm",children:[e.jsxDEV("h3",{className:"font-semibold text-lg mb-2",children:s.name||"Select options below"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:395,columnNumber:13},this),e.jsxDEV("div",{className:"space-y-1",children:e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:s.matchFormat||"Match format will be set automatically"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:399,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:398,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:394,columnNumber:11},this),e.jsxDEV("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(d,{htmlFor:"genderCategory",children:"Gender Category"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:409,columnNumber:15},this),e.jsxDEV(_,{value:s.gender_category,onValueChange:z,children:e.jsxDEV(T,{className:"h-11",children:e.jsxDEV(R,{placeholder:"Select gender category"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:415,columnNumber:19},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:414,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:410,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:408,columnNumber:13},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(d,{htmlFor:"gameType",children:"Game Type"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:429,columnNumber:15},this),e.jsxDEV(_,{value:s.game_type,onValueChange:q,children:[e.jsxDEV(T,{className:"h-11",children:e.jsxDEV(R,{placeholder:"Select game type"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:435,columnNumber:19},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:434,columnNumber:17},this),e.jsxDEV(se,{children:ge.map(a=>e.jsxDEV(oe,{value:a.value,children:a.label},a.value,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:439,columnNumber:21},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:437,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:430,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:428,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:406,columnNumber:11},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(d,{children:"Match Format *"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:449,columnNumber:13},this),e.jsxDEV(k,{value:s.matchFormat,onChange:a=>n(l=>({...l,matchFormat:a.target.value})),placeholder:"e.g., Best of 3 Sets, Pro Sets, etc.",className:"h-11"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:450,columnNumber:13},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Specify the match format for this category"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:461,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:448,columnNumber:11},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(d,{children:"Select Leagues *"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:468,columnNumber:13},this),e.jsxDEV(ie,{open:j,onOpenChange:K,children:[e.jsxDEV(te,{asChild:!0,children:e.jsxDEV(G,{variant:"outline",role:"combobox","aria-expanded":j,className:"w-full justify-between h-11",children:[y.length>0?`${y.length} league(s) selected`:"Select leagues...",e.jsxDEV(ne,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:480,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:471,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:470,columnNumber:15},this),e.jsxDEV(me,{className:"w-full p-0",style:{maxHeight:"400px"},children:e.jsxDEV("div",{className:"p-2",children:[e.jsxDEV(k,{placeholder:"Search leagues...",className:"mb-2",value:D,onChange:a=>Y(a.target.value)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:488,columnNumber:19},this),e.jsxDEV("div",{ref:h,className:"max-h-64 overflow-y-auto overflow-x-hidden",style:{scrollbarWidth:"thin",scrollbarColor:"#d1d5db #f3f4f6",WebkitOverflowScrolling:"touch"},onWheel:a=>{a.preventDefault(),a.stopPropagation(),h.current&&(h.current.scrollTop+=a.deltaY)},children:H?e.jsxDEV("div",{className:"p-2 text-sm text-muted-foreground text-center",children:"Loading leagues..."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:511,columnNumber:23},this):C.length===0?e.jsxDEV("div",{className:"p-2 text-sm text-muted-foreground text-center",children:D?"No leagues found matching your search.":"No leagues found."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:515,columnNumber:23},this):C.map(a=>{var l;return e.jsxDEV("div",{onClick:()=>J(a.id),className:X("flex items-center justify-between px-2 py-1.5 text-sm cursor-pointer rounded-sm hover:bg-accent hover:text-accent-foreground",s.leagueIds.includes(a.id)&&"bg-accent text-accent-foreground"),children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(re,{className:X("mr-2 h-4 w-4",s.leagueIds.includes(a.id)?"opacity-100":"opacity-0")},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:532,columnNumber:29},this),e.jsxDEV("span",{className:"font-medium",children:a.name},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:540,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:531,columnNumber:27},this),e.jsxDEV(B,{variant:Ne(a.sportType),className:"text-xs capitalize",children:((l=a.sportType)==null?void 0:l.toLowerCase())||"Unknown"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:542,columnNumber:27},this)]},a.id,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:522,columnNumber:25},this)})},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:494,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:487,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:483,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:469,columnNumber:13},this),y.length>0&&e.jsxDEV("div",{className:"flex flex-wrap gap-2 mt-2",children:y.map(a=>e.jsxDEV(B,{variant:"secondary",className:"flex items-center gap-1",children:[a.name,e.jsxDEV(de,{className:"h-3 w-3 cursor-pointer",onClick:()=>Q(a.id)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:566,columnNumber:21},this)]},a.id,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:560,columnNumber:19},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:558,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:467,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(ce,{id:"isActive",checked:s.isActive,onCheckedChange:a=>n(l=>({...l,isActive:a}))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:578,columnNumber:13},this),e.jsxDEV(d,{htmlFor:"isActive",children:"Active Category"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:588,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:577,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:392,columnNumber:9},this),e.jsxDEV(ue,{className:"mt-6",children:e.jsxDEV(G,{onClick:ee,disabled:p||!s.name||!s.matchFormat||s.leagueIds.length===0,className:"w-full sm:w-auto",children:p?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(P,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:605,columnNumber:17},this),"Updating..."]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:604,columnNumber:15},this):"Update Category"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:593,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:592,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:377,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/modal/category-edit-modal.tsx",lineNumber:376,columnNumber:5},this)}export{he as default};
