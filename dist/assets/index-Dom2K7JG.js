const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/emoji-picker-react.esm-CsubU2Kf.js","assets/index-CyUfinnt.js","assets/index-BxSHJ7dB.css"])))=>i.map(i=>d[i]);
import{c as J,aJ as ps,aK as Ls,aL as ys,aM as Se,aN as Me,aO as Te,aP as _e,aQ as Ie,aR as Ke,aS as We,r as i,j as e,aT as Qe,aU as Xe,F as Ue,aV as Ze,am as Je,an as es,ao as vs,ap as ss,aq as Ae,d as T,a as ge,u as re,k as ee,l as se,t as Y,N as ns,P as as,Q as ts,R as ls,aW as he,V as As,S as is,I as ms,B as G,L as cs,U as Ne,aX as xe,q as Es,aY as rs,aZ as De,W as Us,a_ as js,a$ as Vs,ag as Cs,o as os,p as ks}from"./index-CyUfinnt.js";import{h as Ss,i as Ms,j as je,e as Ts,m as S,f as be,k as ds,S as Re}from"./site-header-SOpv2JXk.js";import{t as Fe,T as Be,p as $e,q as Oe,g as Ve,r as us,s as hs,v as _s,w as Is}from"./use-notifications-DjWw6umv.js";import{A as z,a as H,b as q}from"./avatar-BoChKG7U.js";import{A as X}from"./index-BVoye_JZ.js";import{S as te}from"./skeleton-Ds9UeeQu.js";import{U as Ee,T as we}from"./user-DvjZsXBK.js";import{A as Rs,a as Fs,b as Bs,c as $s,d as Os,e as Ps,f as Gs,g as zs}from"./alert-dialog-BgIVQFfm.js";import{D as Hs,A as qs}from"./dollar-sign-BBHf7MD3.js";import{C as Ys}from"./circle-CQurUBBk.js";import{s as Ks}from"./subDays-BDXNPs_A.js";import{T as Ns}from"./use-queries-IM_CvREl.js";import{M as gs}from"./mail-CGV4tjem.js";import"./external-DNCVj3zx.js";import"./coerce-BdBvj-GO.js";import"./league-schema-Bh7GxWK0.js";import"./season-schema-ETiAwFYQ.js";import"./division-schema-CZrv0AV0.js";/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Qs=J("arrow-left",Ws);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],pe=J("circle-check-big",Xs);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Pe=J("circle-x",Zs);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],fs=J("external-link",Js);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ce=J("map-pin",en);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M12 8v6",key:"1ib9pf"}],["path",{d:"M9 11h6",key:"1fldmi"}]],Ge=J("message-square-plus",sn);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],an=J("reply",nn);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],ln=J("smile",tn);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],cn=J("square-pen",mn);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],ze=J("users-round",rn);function on(s,a,n){const t=ps(),d=(n==null?void 0:n.locale)??t.locale??Ls,l=Ss(s,a);if(isNaN(l))throw new RangeError("Invalid time value");const g=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:l}),[b,N]=ys(n==null?void 0:n.in,...l>0?[a,s]:[s,a]),x=Ms((n==null?void 0:n.roundingMethod)??"round"),p=N.getTime()-b.getTime(),L=p/Ie,r=Se(N)-Se(b),A=(p-r)/Ie,u=n==null?void 0:n.unit;let v;if(u?v=u:L<1?v="second":L<60?v="minute":L<Me?v="hour":A<Te?v="day":A<_e?v="month":v="year",v==="second"){const o=x(p/1e3);return d.formatDistance("xSeconds",o,g)}else if(v==="minute"){const o=x(L);return d.formatDistance("xMinutes",o,g)}else if(v==="hour"){const o=x(L/60);return d.formatDistance("xHours",o,g)}else if(v==="day"){const o=x(A/Me);return d.formatDistance("xDays",o,g)}else if(v==="month"){const o=x(A/Te);return o===12&&u!=="month"?d.formatDistance("xYears",1,g):d.formatDistance("xMonths",o,g)}else{const o=x(A/_e);return d.formatDistance("xYears",o,g)}}function xs(s,a){return on(s,je(s),a)}function dn(s,a){return Ke(We(s,s),je(s))}function un(s,a){return Ke(We(s,s),Ks(je(s),1))}const hn=["online","away","busy","offline"],He={background:{online:"bg-green-500",away:"bg-yellow-500",busy:"bg-red-500",offline:"bg-gray-500"},text:{online:"text-green-600",away:"text-yellow-600",busy:"text-red-600",offline:"text-gray-600"},border:{online:"border-green-500",away:"border-yellow-500",busy:"border-red-500",offline:"border-gray-500"},ring:{online:"ring-green-500",away:"ring-yellow-500",busy:"ring-red-500",offline:"ring-gray-500"}},Le={AVATAR_SIZES:{MEDIUM:"w-10 h-10",LARGE:"w-12 h-12"}},ae=(s,a="background")=>He[a][s]||He[a].offline,fe=s=>s.charAt(0).toUpperCase()+s.slice(1),ye={FADE_IN:"animate-in fade-in-0 duration-200",PULSE:"animate-pulse"},ce={USER_STATUS:"online",AVATAR_FALLBACK:"?",UNKNOWN_USER:"Unknown User",EMPTY_MESSAGES:"No messages yet"};function Nn({user:s,onStatusChange:a,onSettingsClick:n,onLogoutClick:t,collapsed:d=!1}){const[l,g]=i.useState(ce.USER_STATUS),[b,N]=i.useState(!1),x=(s==null?void 0:s.name)||(s==null?void 0:s.displayName)||ce.UNKNOWN_USER,p=(s==null?void 0:s.email)||"",L=(s==null?void 0:s.image)||(s==null?void 0:s.photoURL)||"",r=x.charAt(0).toUpperCase()||ce.AVATAR_FALLBACK,A=i.useCallback(u=>{g(u),a==null||a(u),console.log("User status changed to:",u)},[a]);return i.useCallback(()=>{N(!1),n==null||n()},[n]),i.useCallback(()=>{N(!1),t==null||t()},[t]),d?e.jsxDEV(Fe,{children:e.jsxDEV(Be,{children:[e.jsxDEV($e,{asChild:!0,children:e.jsxDEV("div",{className:"flex justify-center p-3",children:e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(z,{className:Le.AVATAR_SIZES.MEDIUM,children:[e.jsxDEV(H,{src:L,alt:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:70,columnNumber:19},this),e.jsxDEV(q,{className:"text-sm font-medium",children:r},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:71,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:69,columnNumber:17},this),e.jsxDEV("span",{className:`absolute -bottom-0.5 -right-0.5 h-3 w-3 rounded-full border-2 border-background ${ae(l)}`},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:76,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:68,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:67,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:66,columnNumber:11},this),e.jsxDEV(Oe,{side:"right",children:e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV("p",{className:"font-medium",children:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:84,columnNumber:15},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground capitalize",children:fe(l)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:85,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:83,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:82,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:65,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:64,columnNumber:7},this):e.jsxDEV(Qe,{open:b,onOpenChange:N,children:[e.jsxDEV(Fe,{children:e.jsxDEV(Be,{children:[e.jsxDEV($e,{asChild:!0,children:e.jsxDEV(Xe,{asChild:!0,children:e.jsxDEV("div",{className:`flex items-center gap-3 p-3 cursor-pointer hover:bg-muted/50 rounded-lg transition-colors ${ye.FADE_IN}`,children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(z,{className:Le.AVATAR_SIZES.MEDIUM,children:[e.jsxDEV(H,{src:L,alt:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:106,columnNumber:21},this),e.jsxDEV(q,{className:"text-sm font-medium",children:r},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:107,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:105,columnNumber:19},this),e.jsxDEV("span",{className:`absolute -bottom-0.5 -right-0.5 h-3 w-3 rounded-full border-2 border-background ${ae(l)} ${l==="online"?ye.PULSE:""}`},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:112,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:104,columnNumber:17},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("div",{className:"font-medium text-sm truncate",children:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:119,columnNumber:19},this),e.jsxDEV("div",{className:"flex items-center gap-2 mt-1",children:e.jsxDEV(Ue,{variant:"outline",className:`text-xs px-2 py-0.5 ${ae(l,"text")} border-current`,children:fe(l)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:123,columnNumber:21},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:122,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:118,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:102,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:101,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:100,columnNumber:11},this),e.jsxDEV(Oe,{children:e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-medium",children:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:136,columnNumber:15},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:p},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:137,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:135,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:134,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:99,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:98,columnNumber:7},this),e.jsxDEV(Ze,{className:`w-80 p-0 ${ye.FADE_IN}`,align:"start",children:[e.jsxDEV("div",{className:"flex items-center gap-3 p-4 bg-muted/50",children:[e.jsxDEV(z,{className:Le.AVATAR_SIZES.LARGE,children:[e.jsxDEV(H,{src:L,alt:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:147,columnNumber:13},this),e.jsxDEV(q,{className:"text-lg font-medium",children:r},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:148,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:146,columnNumber:11},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("div",{className:"font-semibold text-base truncate",children:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:153,columnNumber:13},this),e.jsxDEV("div",{className:"text-sm text-muted-foreground truncate",children:p},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:154,columnNumber:13},this),(s==null?void 0:s.username)&&e.jsxDEV("div",{className:"text-xs text-muted-foreground",children:["@",s.username]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:156,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:152,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:145,columnNumber:9},this),e.jsxDEV(Ts,{},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:161,columnNumber:9},this),e.jsxDEV("div",{className:"p-4 space-y-3",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("span",{className:"text-sm font-medium",children:"Status"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:166,columnNumber:13},this),e.jsxDEV("span",{className:`h-2 w-2 rounded-full ${ae(l)}`},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:167,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:165,columnNumber:11},this),e.jsxDEV(Je,{value:l,onValueChange:A,children:[e.jsxDEV(es,{className:"w-full",children:e.jsxDEV(vs,{children:e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:`h-2 w-2 rounded-full ${ae(l)}`},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:176,columnNumber:19},this),e.jsxDEV("span",{className:"capitalize",children:fe(l)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:179,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:175,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:174,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:173,columnNumber:13},this),e.jsxDEV(ss,{children:hn.map(u=>e.jsxDEV(Ae,{value:u,children:e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:`h-2 w-2 rounded-full ${ae(u)}`},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:187,columnNumber:21},this),e.jsxDEV("span",{className:"capitalize",children:fe(u)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:190,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:186,columnNumber:19},this)},u,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:185,columnNumber:17},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:183,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:172,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:164,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:143,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-account.tsx",lineNumber:97,columnNumber:5},this)}const gn=({className:s,index:a=0,...n})=>{const t=`${a*75}ms`;return e.jsxDEV("div",{className:T("flex flex-row items-center gap-3 px-4 py-3.5",s),style:{animationDelay:t},...n,children:[e.jsxDEV("div",{className:"w-12 h-12 rounded-full bg-muted animate-pulse shrink-0",style:{animationDelay:t}},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-skeleton.tsx",lineNumber:24,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[e.jsxDEV("div",{className:"h-4 rounded-md bg-muted animate-pulse",style:{width:`${55+a%3*15}%`,animationDelay:t}},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-skeleton.tsx",lineNumber:33,columnNumber:11},void 0),e.jsxDEV("div",{className:"h-3 w-10 rounded-md bg-muted/60 animate-pulse shrink-0",style:{animationDelay:t}},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-skeleton.tsx",lineNumber:40,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-skeleton.tsx",lineNumber:32,columnNumber:9},void 0),e.jsxDEV("div",{className:"h-3 rounded-md bg-muted/70 animate-pulse",style:{width:`${70+a%4*8}%`,animationDelay:t}},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-skeleton.tsx",lineNumber:46,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-skeleton.tsx",lineNumber:30,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-skeleton.tsx",lineNumber:15,columnNumber:5},void 0)};function fn({matchData:s}){return e.jsxDEV("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-slate-100 text-slate-600",children:"Scheduled a match"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-match-badge.tsx",lineNumber:10,columnNumber:5},this)}function Ds(s){switch(s==null?void 0:s.toUpperCase()){case"PICKLEBALL":return{label:"Pickleball",badgeColor:"#7C3AED",badgeBg:"#F3E8FF",buttonColor:"#7C3AED"};case"TENNIS":return{label:"Tennis",badgeColor:"#059669",badgeBg:"#ECFDF5",buttonColor:"#059669"};case"PADEL":return{label:"Padel",badgeColor:"#2563EB",badgeBg:"#EFF6FF",buttonColor:"#2563EB"};default:return{label:s||"Sport",badgeColor:"#6B7280",badgeBg:"#F3F4F6",buttonColor:"#6B7280"}}}function xn({seasonName:s,sportType:a}){if(!s)return null;const n=Ds(a);return e.jsxDEV("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium",style:{backgroundColor:n.badgeBg,color:n.badgeColor},children:s},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-context-badge.tsx",lineNumber:17,columnNumber:5},this)}const Dn=(s,a)=>{const[n,t]=i.useState(!1);return i.useEffect(()=>{const d=window.matchMedia("(min-width: 768px)"),l=g=>t(g.matches);return d.addEventListener("change",l),l(d),()=>d.removeEventListener("change",l)},[]),n},bn=(s,a=6)=>{if(!s)return"";const n=s.trim().split(/\s+/);return n.length<=a?s:n.slice(0,a).join(" ")+"..."},wn=({conversation:s,currentUserId:a})=>{var c,D,y,C,M,m,E,_,R,O,P,Z,W,j,$;const n=(s==null?void 0:s.type)==="group",t=n?(s==null?void 0:s.participants)||[]:((c=s==null?void 0:s.participants)==null?void 0:c.filter(Q=>Q.id!==a))||[],d=n?(s==null?void 0:s.displayName)||(s==null?void 0:s.name)||"Group Chat":(s==null?void 0:s.displayName)||((D=t[0])==null?void 0:D.name)||((y=t[0])==null?void 0:y.displayName)||ce.UNKNOWN_USER,l=((C=s==null?void 0:s.lastMessage)==null?void 0:C.content)||"",g=bn(l,6),b=(M=s==null?void 0:s.lastMessage)==null?void 0:M.createdAt,N=n&&((m=s==null?void 0:s.participants)==null?void 0:m.some(Q=>Q.status==="online")),x=(_=(E=s==null?void 0:s.division)==null?void 0:E.season)==null?void 0:_.name,p=(O=(R=s==null?void 0:s.division)==null?void 0:R.league)==null?void 0:O.sportType,L=n&&(x||p),r=s==null?void 0:s.lastMessage,A=(r==null?void 0:r.messageType)==="MATCH"&&((P=r==null?void 0:r.matchData)==null?void 0:P.status)==="SCHEDULED",u=A?r==null?void 0:r.matchData:null,v=(r==null?void 0:r.senderId)||((Z=r==null?void 0:r.sender)==null?void 0:Z.id),o=v?(W=s==null?void 0:s.participants)==null?void 0:W.find(Q=>Q.id===v):null,f=((o==null?void 0:o.name)||((j=r==null?void 0:r.sender)==null?void 0:j.name)||"").split(" ")[0]||"",w=(o==null?void 0:o.image)||(o==null?void 0:o.photoURL)||(($=r==null?void 0:r.sender)==null?void 0:$.image);return{group:n,displayName:d,displayText:g,participants:t,lastActivity:b,hasOnlineInGroup:N,seasonName:x,sportType:p,hasDivisionContext:L,isScheduledMatch:A,matchData:u,senderFirstName:f,senderAvatar:w}},pn={dashboard:{chat:"/chat"}},Ln=s=>s.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().slice(0,2),yn=s=>{const a=s.trim().split(" ");return a.length===1?a[0].slice(0,2).toUpperCase():a.slice(0,2).map(n=>n.charAt(0)).join("").toUpperCase()},qe=({selected:s,conversation:a,onCloseMobile:n,hideContextBadge:t=!1})=>{const{data:d}=ge(),l=d==null?void 0:d.user,g=re(),b=Dn(),{group:N,displayName:x,displayText:p,participants:L,lastActivity:r,hasOnlineInGroup:A,seasonName:u,sportType:v,hasDivisionContext:o,isScheduledMatch:h,matchData:f,senderFirstName:w,senderAvatar:c}=wn({conversation:a,currentUserId:l==null?void 0:l.id}),D=L[0],{name:y,photoURL:C,status:M}=D||{},m=i.useCallback(async()=>{try{!b&&n&&n(),g({to:`${pn.dashboard.chat}?id=${a.id}`})}catch(R){console.error(R)}},[a.id,b,n,g]),E=e.jsxDEV("div",{className:"relative flex-shrink-0",children:[e.jsxDEV(z,{className:"h-12 w-12",children:[e.jsxDEV(H,{src:a.avatarUrl||a.photoURL,alt:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:196,columnNumber:9},void 0),e.jsxDEV(q,{className:"text-sm bg-gradient-to-br from-brand-dark to-brand-light text-white font-semibold",children:yn(x)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:200,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:195,columnNumber:7},void 0),A&&e.jsxDEV("span",{className:"absolute bottom-0.5 right-0.5 h-3 w-3 rounded-full bg-green-500 ring-2 ring-background"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:205,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:194,columnNumber:5},void 0),_=e.jsxDEV("div",{className:"relative flex-shrink-0",children:[e.jsxDEV(z,{className:"h-12 w-12",children:[e.jsxDEV(H,{src:C||(D==null?void 0:D.photoURL),alt:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:213,columnNumber:9},void 0),e.jsxDEV(q,{className:"text-sm bg-muted font-medium",children:Ln(x)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:217,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:212,columnNumber:7},void 0),M==="online"&&e.jsxDEV("span",{className:"absolute bottom-0.5 right-0.5 h-3 w-3 rounded-full bg-green-500 ring-2 ring-background"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:222,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:211,columnNumber:5},void 0);return e.jsxDEV("div",{onClick:m,className:T("flex items-center gap-3 px-4 py-3.5 cursor-pointer transition-colors",s?"bg-muted":"hover:bg-muted/50"),children:[N?E:_,e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[e.jsxDEV("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsxDEV("span",{className:"font-semibold text-[15px] truncate",children:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:243,columnNumber:13},void 0),o&&!t&&e.jsxDEV(xn,{seasonName:u,sportType:v},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:247,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:242,columnNumber:11},void 0),e.jsxDEV("span",{className:"text-xs text-muted-foreground/70 flex-shrink-0",children:r?xs(new Date(r),{addSuffix:!1}):""},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:250,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:241,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center justify-between mt-0.5",children:[e.jsxDEV("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[N&&w&&e.jsxDEV(z,{className:"h-4 w-4 flex-shrink-0",children:[e.jsxDEV(H,{src:c,alt:w},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:265,columnNumber:17},void 0),e.jsxDEV(q,{className:"text-[8px] bg-muted",children:w.charAt(0).toUpperCase()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:266,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:264,columnNumber:15},void 0),h&&f?e.jsxDEV("div",{className:"flex items-center gap-1.5 min-w-0",children:[N&&w&&e.jsxDEV("span",{className:"text-sm text-foreground font-medium flex-shrink-0",children:[w,":"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:274,columnNumber:19},void 0),e.jsxDEV(fn,{matchData:f},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:278,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:272,columnNumber:15},void 0):e.jsxDEV("span",{className:"text-sm text-muted-foreground truncate",children:N&&w?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{className:"font-medium text-foreground",children:[w,":"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:284,columnNumber:21},void 0)," ",p||ce.EMPTY_MESSAGES]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:283,columnNumber:19},void 0):p||ce.EMPTY_MESSAGES},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:281,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:261,columnNumber:11},void 0),e.jsxDEV(X,{children:a.unreadCount>0&&!s&&e.jsxDEV(S.span,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},transition:{type:"spring",stiffness:500,damping:25},className:"h-5 min-w-5 px-1.5 rounded-full bg-destructive text-white text-xs font-medium flex items-center justify-center flex-shrink-0 ml-2",children:a.unreadCount>99?"99+":a.unreadCount},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:296,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:294,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:260,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:239,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav-item.tsx",lineNumber:228,columnNumber:5},void 0)};function vn(s,a){const[n,t]=i.useState([]),[d,l]=i.useState(!0),[g,b]=i.useState(null),{socket:N,isConnected:x}=Ve(),p=i.useRef(a);p.current=a;const L=i.useRef(null),r=i.useCallback(async()=>{var o,h,f,w;if(!s)return l(!1),[];try{l(!0),b(null);const c=await ee.get(se.chat.getThreads(s));let D=[];c.data&&(c.data.success&&c.data.data?D=c.data.data:Array.isArray(c.data)?D=c.data:c.data.threads&&Array.isArray(c.data.threads)&&(D=c.data.threads));const y=p.current;return y&&(D=D.map(C=>C.id===y?{...C,unreadCount:0}:C)),t(D),D}catch(c){console.error("Error fetching threads:",c);const D=((h=(o=c.response)==null?void 0:o.data)==null?void 0:h.message)||((w=(f=c.response)==null?void 0:f.data)==null?void 0:w.error)||c.message||"Failed to fetch threads";return b(D),Y.error("Failed to load chat threads"),t([]),[]}finally{l(!1)}},[s]);i.useEffect(()=>{if(!N||!x)return;const o=D=>{t(y=>[D.thread,...y]),Y.success("New conversation started!")},h=D=>{t(y=>y.map(C=>C.id===D.threadId?{...C,messages:[D.lastMessage],updatedAt:new Date().toISOString()}:C))},f=D=>{D.threadId===a&&D.senderId!==s&&(L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{ee.post(se.chat.markThreadAsRead(D.threadId)).catch(()=>{})},500)),t(y=>{const C=y.findIndex(_=>_.id===D.threadId);if(C===-1)return y;const M=y[C],m=D.senderId!==s&&D.threadId!==a;return[{...M,messages:[D],updatedAt:new Date().toISOString(),unreadCount:m?(M.unreadCount||0)+1:M.unreadCount},...y.filter(_=>_.id!==D.threadId)]})},w=D=>{D.threadId!==a&&t(y=>y.map(C=>C.id===D.threadId?{...C,unreadCount:D.unreadCount}:C))},c=D=>{t(y=>y.map(C=>C.id===D.threadId?{...C,unreadCount:0}:C))};return N.on("new_thread",o),N.on("thread_updated",h),N.on("new_message",f),N.on("unread_count_update",w),N.on("thread_marked_read",c),()=>{N.off("new_thread",o),N.off("thread_updated",h),N.off("new_message",f),N.off("unread_count_update",w),N.off("thread_marked_read",c),L.current&&clearTimeout(L.current)}},[N,x,s,a]),i.useEffect(()=>{r()},[r]),i.useEffect(()=>{if(!N||!x||n.length===0)return;const o=n.map(h=>h.id);return o.forEach(h=>{N.emit("join_thread",h)}),console.log(`ðŸ“¥ [Socket] Joined ${o.length} thread rooms for real-time updates`),()=>{o.forEach(h=>{N.emit("leave_thread",h)}),console.log(`ðŸ“¤ [Socket] Left ${o.length} thread rooms`)}},[N,x,n.length]);const A=i.useCallback((o,h)=>{t(f=>f.some(D=>D.id===o)?[{...f.find(D=>D.id===o),messages:[h],updatedAt:new Date().toISOString()},...f.filter(D=>D.id!==o)]:f)},[]),u=i.useCallback(o=>{t(h=>h.some(f=>f.id===o.id)?h:[o,...h])},[]),v=i.useCallback(async o=>{try{await ee.post(se.chat.markThreadAsRead(o)),t(h=>h.map(f=>f.id===o?{...f,unreadCount:0}:f))}catch(h){console.error("Failed to mark thread as read:",h)}},[]);return{threads:n,loading:d,error:g,refetch:r,updateThreadLastMessage:A,addThreadOptimistically:u,markThreadAsRead:v}}function An(s){const[a,n]=i.useState([]),[t,d]=i.useState(!1),[l,g]=i.useState(null),{socket:b,isConnected:N,joinThread:x,leaveThread:p}=Ve(),L=i.useRef(null),r=i.useCallback(async()=>{var o,h,f,w;if(!s){n([]);return}try{d(!0),g(null);const c=await ee.get(se.chat.getMessages(s));c.data?c.data.success&&c.data.data?n(Array.isArray(c.data.data)?c.data.data:[]):Array.isArray(c.data)?n(c.data):c.data.messages&&Array.isArray(c.data.messages)?n(c.data.messages):n([]):n([])}catch(c){console.error("Error fetching messages:",c);const D=((h=(o=c.response)==null?void 0:o.data)==null?void 0:h.message)||((w=(f=c.response)==null?void 0:f.data)==null?void 0:w.error)||c.message||"Failed to fetch messages";g(D),n([])}finally{d(!1)}},[s]),A=i.useCallback(async(o,h,f)=>{var c,D,y,C;if(!s)return;const w={id:`temp-${Date.now()}`,threadId:s,senderId:h,content:o,createdAt:new Date().toISOString(),sender:{id:h,name:"You"}};n(M=>[...M,w]);try{const M={senderId:h,content:o};f&&(M.repliesToId=f);const m=await ee.post(se.chat.sendMessage(s),M);let E=null;if(m.data&&(m.data.success&&m.data.data?E=m.data.data:m.data.message?E=m.data.message:m.data.id&&(E=m.data)),E)return console.log("âœ… Message sent successfully, waiting for socket broadcast"),E}catch(M){n(E=>E.filter(_=>_.id!==w.id)),console.error("Error sending message:",M);const m=((D=(c=M.response)==null?void 0:c.data)==null?void 0:D.message)||((C=(y=M.response)==null?void 0:y.data)==null?void 0:C.error)||M.message||"Failed to send message";throw Y.error(m),M}},[s]),u=i.useCallback(async o=>{var f,w,c,D;if(!s)return;const h=[...a];try{return n(y=>y.map(C=>C.id===o?{...C,isDeleted:!0,deletedAt:new Date().toISOString(),content:"This message has been deleted"}:C)),await ee.delete(se.chat.deleteMessage(o)),Y.success("Message deleted successfully"),!0}catch(y){n(h);const C=((w=(f=y.response)==null?void 0:f.data)==null?void 0:w.message)||((D=(c=y.response)==null?void 0:c.data)==null?void 0:D.error)||y.message||"Failed to delete message";throw Y.error(C),y}},[s,a]);i.useEffect(()=>{if(!b||!N)return;const o=c=>{var D;console.log("ðŸ”” [Socket] Received new_message event:",{messageId:c.id,threadId:c.threadId,currentThreadId:s,senderId:c.senderId,content:(D=c.content)==null?void 0:D.substring(0,50)}),c.threadId===s?n(y=>y.some(m=>m.id===c.id)?(console.log("âš ï¸ [Socket] Message already exists, skipping duplicate:",c.id),y):y.some(m=>m.id.startsWith("temp-"))?(console.log("ðŸ”„ [Socket] Found temp message, replacing with real message:",c.id),[...y.filter(m=>!m.id.startsWith("temp-")),c]):(console.log("âœ… [Socket] Adding new message to state:",c.id),[...y,c])):console.log("â­ï¸ [Socket] Message not for current thread, ignoring")},h=c=>{console.log("ðŸ—‘ï¸ [Socket] Received message_deleted event:",c),c.threadId===s&&n(D=>D.map(y=>y.id===c.messageId?{...y,isDeleted:!0,deletedAt:new Date().toISOString(),content:"This message has been deleted"}:y))},f=c=>{},w=c=>{c.threadId===s&&n(D=>D.map(y=>y.id===c.messageId?{...y,readBy:[...y.readBy||[],{id:`${c.messageId}-${c.readerId}`,userId:c.readerId,messageId:c.messageId,readAt:new Date().toISOString(),user:{id:c.readerId,name:c.readerName}}]}:y))};return b.on("new_message",o),b.on("message_deleted",h),b.on("message_sent",f),b.on("message_read",w),()=>{b.off("new_message",o),b.off("message_deleted",h),b.off("message_sent",f),b.off("message_read",w)}},[b,N,s]),i.useEffect(()=>{if(!(!s||!N))return L.current&&L.current!==s&&(console.log("ðŸ‘‹ [Socket] Leaving previous thread:",L.current),p(L.current)),console.log("ðŸšª [Socket] Joining thread room:",s),x(s),L.current=s,()=>{s&&(p(s),L.current=null)}},[s,N,x,p]);const v=i.useCallback(async o=>{try{await ee.post(se.chat.markAsRead(o))}catch{}},[]);return i.useEffect(()=>{r()},[r]),{messages:a,loading:t,error:l,sendMessage:A,deleteMessage:u,markAsRead:v,refetch:r}}function bs(s,a){const[n,t]=i.useState([]),{socket:d,isConnected:l,sendTyping:g}=Ve(),{data:b}=ge(),N=b==null?void 0:b.user,x=i.useRef(void 0);i.useEffect(()=>()=>{x.current&&(clearTimeout(x.current),x.current=void 0),t([])},[s]),i.useEffect(()=>{if(!d||!l||!s)return;const L=r=>{r.threadId===s&&r.senderId!==(N==null?void 0:N.id)&&t(A=>{var u,v;if(r.isTyping){if(A.some(w=>w.userId===r.senderId))return A;const h=a==null?void 0:a.find(w=>("userId"in w?w.userId:w.id)===r.senderId),f=h?"user"in h?((u=h.user)==null?void 0:u.name)||((v=h.user)==null?void 0:v.username):h.name||h.username:"Someone";return[...A,{userId:r.senderId,userName:f||"Someone"}]}else return A.filter(o=>o.userId!==r.senderId)})};return d.on("typing_status",L),()=>{d.off("typing_status",L)}},[d,l,s,N==null?void 0:N.id,a]);const p=i.useCallback(L=>{s&&(g(s,L),L?(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{g(s,!1)},3e3)):x.current&&(clearTimeout(x.current),x.current=void 0))},[s,g]);return{typingUsers:n,setTyping:p}}function En(){const[s,a]=i.useState(!1),[n,t]=i.useState(null);return{createThread:i.useCallback(async l=>{var g,b,N,x;try{a(!0),t(null);const p=await ee.post(se.chat.createThread,l);if(p.data){let L=null;if(p.data.success&&p.data.data?L=p.data.data:p.data.thread?L=p.data.thread:p.data.id&&(L=p.data),L)return Y.success("Thread created successfully"),L}throw new Error("Failed to create thread")}catch(p){console.error("Error creating thread:",p);const L=((b=(g=p.response)==null?void 0:g.data)==null?void 0:b.message)||((x=(N=p.response)==null?void 0:N.data)==null?void 0:x.error)||p.message||"Failed to create thread";throw t(L),Y.error(L),p}finally{a(!1)}},[]),loading:s,error:n}}function Un(s){const[a,n]=i.useState([]),[t,d]=i.useState(!1),[l,g]=i.useState(null),b=i.useCallback(async()=>{var N,x,p,L;if(!s){n([]);return}try{d(!0),g(null);const r=await ee.get(se.chat.getAvailableUsers(s));let A=[];r.data&&(r.data.success&&r.data.data?A=r.data.data:Array.isArray(r.data)?A=r.data:r.data.users&&Array.isArray(r.data.users)&&(A=r.data.users));const u=A.filter(v=>v.id!==s);n(u)}catch(r){console.error("Error fetching available users:",r);const A=((x=(N=r.response)==null?void 0:N.data)==null?void 0:x.message)||((L=(p=r.response)==null?void 0:p.data)==null?void 0:L.error)||r.message||"Failed to fetch users";g(A),n([])}finally{d(!1)}},[s]);return i.useEffect(()=>{b()},[b]),{users:a,loading:t,error:l,refetch:b}}const jn=(s,a)=>{if(a)return"Active now";if(!s)return"";try{const n=new Date(s);return`Active ${ds(n)} ago`}catch{return""}},Vn=()=>e.jsxDEV("div",{className:"flex items-center gap-3 p-3",children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(te,{className:"h-10 w-10 rounded-full"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:46,columnNumber:7},void 0),e.jsxDEV(te,{className:"absolute bottom-0 right-0 h-3 w-3 rounded-full"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:47,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:45,columnNumber:5},void 0),e.jsxDEV("div",{className:"flex-1 space-y-1.5",children:[e.jsxDEV(te,{className:"h-4 w-32"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:50,columnNumber:7},void 0),e.jsxDEV(te,{className:"h-3 w-40"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:51,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:49,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:44,columnNumber:3},void 0);function Cn({open:s,onOpenChange:a,currentUserId:n,onThreadCreated:t,addThreadOptimistically:d}){const l=re(),[g,b]=i.useState(""),[N,x]=i.useState(null),{users:p,loading:L,error:r,refetch:A}=Un(n),{createThread:u}=En(),v=i.useMemo(()=>{if(!g.trim())return p;const f=g.toLowerCase();return p.filter(w=>{var c,D;return w.name.toLowerCase().includes(f)||((c=w.username)==null?void 0:c.toLowerCase().includes(f))||((D=w.email)==null?void 0:D.toLowerCase().includes(f))})},[p,g]),o=async f=>{if(!(!n||N))try{x(f.id);const w={name:void 0,isGroup:!1,userIds:[n,f.id],createdBy:n},c=await u(w);c&&(d&&d(c),x(null),a(!1),b(""),l({to:"/chat",search:{id:c.id}}),t==null||t(),Y.success(`Chat with ${f.name} started!`))}catch{Y.error("Failed to start chat. Please try again."),x(null)}},h=()=>{N||(a(!1),b(""))};return e.jsxDEV(ns,{open:s,onOpenChange:h,children:e.jsxDEV(as,{className:"max-w-md h-[500px] flex flex-col p-0",children:[e.jsxDEV(ts,{className:"px-6 pt-6 pb-4",children:[e.jsxDEV(ls,{className:"flex items-center gap-2",children:[e.jsxDEV(he,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:134,columnNumber:13},this),"Start New Chat"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:133,columnNumber:11},this),e.jsxDEV(As,{children:"Click on a user to start chatting"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:137,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:132,columnNumber:9},this),e.jsxDEV("div",{className:"px-6 space-y-4 flex-1 flex flex-col overflow-hidden",children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(is,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:145,columnNumber:13},this),e.jsxDEV(ms,{placeholder:"Search users...",value:g,onChange:f=>b(f.target.value),className:"pl-9",disabled:!!N},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:146,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:144,columnNumber:11},this),e.jsxDEV("div",{className:"flex-1 overflow-hidden",children:e.jsxDEV(be,{className:"h-full",children:L?e.jsxDEV("div",{className:"space-y-2",children:Array.from({length:5}).map((f,w)=>e.jsxDEV(Vn,{},w,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:161,columnNumber:21},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:159,columnNumber:17},this):r?e.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsxDEV("div",{className:"text-4xl mb-2",children:"âš ï¸"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:166,columnNumber:19},this),e.jsxDEV("p",{className:"text-sm mb-2",children:"Failed to load users"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:167,columnNumber:19},this),e.jsxDEV("p",{className:"text-xs mb-3",children:r},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:168,columnNumber:19},this),e.jsxDEV(G,{size:"sm",variant:"outline",onClick:A,children:"Try Again"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:169,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:165,columnNumber:17},this):v.length===0?e.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsxDEV("div",{className:"text-4xl mb-2",children:g?"ðŸ”":"ðŸ‘¥"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:175,columnNumber:19},this),e.jsxDEV("p",{className:"text-sm mb-1",children:g?"No users found":"No available users"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:178,columnNumber:19},this),e.jsxDEV("p",{className:"text-xs",children:g?"Try a different search term":"All users already have conversations with you"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:181,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:174,columnNumber:17},this):e.jsxDEV("div",{className:"space-y-1",children:v.map(f=>{const w=N===f.id,c=jn(f.lastActiveAt,f.isOnline);return e.jsxDEV("div",{onClick:()=>!N&&o(f),className:T("flex items-center gap-3 p-3 rounded-md transition-colors",!N&&"cursor-pointer hover:bg-muted/50",N&&N!==f.id&&"opacity-50",w&&"bg-muted border border-brand-light/20"),children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(z,{className:"h-10 w-10",children:[e.jsxDEV(H,{src:f.image,alt:f.name},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:208,columnNumber:29},this),e.jsxDEV(q,{children:f.name.charAt(0).toUpperCase()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:209,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:207,columnNumber:27},this),e.jsxDEV("div",{className:T("absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-background",f.isOnline?"bg-green-500":"bg-gray-400"),"aria-label":f.isOnline?"Online":"Offline"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:215,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:206,columnNumber:25},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("p",{className:"text-sm font-medium truncate",children:f.name},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:226,columnNumber:27},this),e.jsxDEV("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsxDEV("span",{className:"truncate",children:f.username?`@${f.username}`:f.email},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:232,columnNumber:29},this),c&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{className:"text-muted-foreground/50",children:"â€¢"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:239,columnNumber:33},this),e.jsxDEV("span",{className:T("flex-shrink-0",f.isOnline?"text-green-600 dark:text-green-500":"text-muted-foreground/70"),children:c},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:240,columnNumber:33},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:238,columnNumber:31},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:231,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:224,columnNumber:25},this),w&&e.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsxDEV(cs,{className:"h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:253,columnNumber:29},this),e.jsxDEV("span",{children:"Creating chat..."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:254,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:252,columnNumber:27},this)]},f.id,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:195,columnNumber:23},this)})},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:189,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:157,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:156,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:142,columnNumber:9},this),e.jsxDEV("div",{className:"px-6 py-4 border-t flex justify-end",children:e.jsxDEV(G,{variant:"outline",onClick:h,disabled:!!N,children:N?"Creating...":"Cancel"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:268,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:267,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:131,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/create-chat-modal.tsx",lineNumber:130,columnNumber:5},this)}const kn=()=>{const[s,a]=i.useState(!1);return i.useEffect(()=>{const n=window.matchMedia("(min-width: 768px)"),t=d=>a(d.matches);return n.addEventListener("change",t),t(n),()=>n.removeEventListener("change",t)},[]),s},Sn=()=>{const[s,a]=i.useState(!1),[n,t]=i.useState(!1);return{collapseDesktop:s,onCollapseDesktop:()=>a(d=>!d),onCloseDesktop:()=>a(!1),openMobile:n,onOpenMobile:()=>t(!0),onCloseMobile:()=>t(!1)}},Mn=(s=!1)=>{const[a,n]=i.useState(s);return{value:a,onTrue:()=>n(!0),onFalse:()=>n(!1),onToggle:()=>n(t=>!t)}};function Ye({loading:s,user:a,conversations:n,selectedConversationId:t,onConversationSelect:d,onThreadCreated:l,forceMobileList:g=!1,addThreadOptimistically:b}){re();const N=kn(),{openMobile:x,onOpenMobile:p,onCloseMobile:L}=Sn(),{value:r,onTrue:A,onFalse:u}=Mn(!1),[v,o]=i.useState(""),[h,f]=i.useState("all"),[w,c]=i.useState(null),D=i.useRef(null);i.useEffect(()=>{h!=="division"&&c(null)},[h]),i.useEffect(()=>{if(D.current){const V=D.current.querySelector("[data-radix-scroll-area-viewport]");V&&(V.scrollTop=0)}},[h,w]);const y=i.useMemo(()=>{const V=n.filter(I=>I.type==="direct").length,k=n.filter(I=>I.type==="group").length;return{all:n.length,personal:V,division:k}},[n]),C=i.useMemo(()=>{const V=n.filter(I=>I.type==="group"),k=new Map;return V.forEach(I=>{var K,F,oe,de;const U=(F=(K=I.division)==null?void 0:K.season)==null?void 0:F.id,B=(de=(oe=I.division)==null?void 0:oe.season)==null?void 0:de.name;if(U&&B){const ue=k.get(U);ue?ue.count+=1:k.set(U,{id:U,name:B,count:1})}}),Array.from(k.values()).sort((I,U)=>I.name.localeCompare(U.name))},[n]),M=i.useMemo(()=>{let V=n;return h==="personal"?V=V.filter(k=>k.type==="direct"):h==="division"&&(V=V.filter(k=>k.type==="group"),w&&(V=V.filter(k=>{var I,U;return((U=(I=k.division)==null?void 0:I.season)==null?void 0:U.id)===w})),V=[...V].sort((k,I)=>(k.displayName||"").localeCompare(I.displayName||""))),v.trim()&&(V=V.filter(k=>{var K;const I=k.displayName||"",U=((K=k.participants)==null?void 0:K.map(F=>F.displayName||F.name||"").join(" "))||"";return(I+" "+U).toLowerCase().includes(v.toLowerCase())})),V},[n,h,v,w]),m=i.useCallback(()=>{N||L(),A()},[N,L,A]),E=i.useCallback(V=>{o(V)},[]),_=i.useCallback(()=>{o("")},[]),R=i.useCallback(async()=>{await(l==null?void 0:l())},[l]),O=()=>e.jsxDEV(G,{onClick:p,variant:"ghost",className:"fixed left-0 top-[68px] md:top-[84px] z-50 h-11 w-11 rounded-r-lg bg-primary text-primary-foreground shadow-lg hover:bg-primary/90 md:hidden transition-all","aria-label":"Open chat navigation",children:e.jsxDEV(Ne,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:249,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:243,columnNumber:5},this),P=()=>e.jsxDEV("div",{className:"space-y-0",children:Array.from({length:8},(V,k)=>e.jsxDEV(gn,{index:k},`skeleton-${k}`,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:256,columnNumber:9},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:254,columnNumber:5},this),Z=()=>{const V=()=>{var I;return v?"No conversations found":h==="personal"?"No personal chats":h==="division"?w?`No chats in ${((I=C.find(B=>B.id===w))==null?void 0:I.name)||"this season"}`:"No division chats":"No conversations yet"},k=()=>v?"Try a different search term":h==="division"&&w?"Try selecting a different season or 'All Seasons'":h!=="all"?"Try selecting a different filter":"Start a new conversation";return e.jsxDEV(S.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},exit:{opacity:0,y:-12},transition:{duration:.3,ease:[.4,0,.2,1]},className:"flex flex-col items-center justify-center py-8 text-center px-4",children:[e.jsxDEV("div",{className:"w-12 h-12 rounded-full bg-muted/50 flex items-center justify-center mb-4",children:h==="personal"?e.jsxDEV(Ee,{className:"w-6 h-6 text-muted-foreground/60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:295,columnNumber:13},this):h==="division"?e.jsxDEV(ze,{className:"w-6 h-6 text-muted-foreground/60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:297,columnNumber:13},this):e.jsxDEV(Ge,{className:"w-6 h-6 text-muted-foreground/60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:299,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:293,columnNumber:9},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground mb-2",children:V()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:302,columnNumber:9},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground/70",children:k()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:305,columnNumber:9},this),!v&&h==="all"&&e.jsxDEV(G,{variant:"outline",size:"sm",className:"mt-4",onClick:m,children:[e.jsxDEV(Ge,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:315,columnNumber:13},this),"New Message"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:309,columnNumber:11},this)]},"empty-state",!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:285,columnNumber:7},this)},W=i.useMemo(()=>{if(h!=="division"||w)return null;const V=new Map,k=[];M.forEach(U=>{var F,oe,de,ue;const B=(oe=(F=U.division)==null?void 0:F.season)==null?void 0:oe.id,K=(ue=(de=U.division)==null?void 0:de.season)==null?void 0:ue.name;if(B&&K){const ke=V.get(B);ke?ke.conversations.push(U):V.set(B,{seasonName:K,conversations:[U]})}else k.push(U)});const I=Array.from(V.entries()).sort(([,U],[,B])=>U.seasonName.localeCompare(B.seasonName)).map(([U,B])=>({id:U,seasonName:B.seasonName,conversations:B.conversations.sort((K,F)=>(K.displayName||"").localeCompare(F.displayName||""))}));return k.length>0&&I.push({id:"no-season",seasonName:"Other",conversations:k.sort((U,B)=>(U.displayName||"").localeCompare(B.displayName||""))}),I},[h,w,M]),j=()=>e.jsxDEV(X,{mode:"popLayout",initial:!1,children:M.length>0?e.jsxDEV(S.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{},visible:{transition:{staggerChildren:.04}}},children:W?W.map(V=>e.jsxDEV("div",{children:[e.jsxDEV(S.div,{variants:{hidden:{opacity:0},visible:{opacity:1}},className:"sticky top-0 z-10 px-3 py-2 bg-background/95 backdrop-blur-sm border-b border-border/50",children:e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:"text-[11px] font-semibold text-muted-foreground uppercase tracking-wide",children:V.seasonName},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:400,columnNumber:21},this),e.jsxDEV("span",{className:"text-[10px] text-muted-foreground/60",children:["(",V.conversations.length,")"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:403,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:399,columnNumber:19},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:392,columnNumber:17},this),V.conversations.map(k=>e.jsxDEV(S.div,{variants:{hidden:{opacity:0},visible:{opacity:1}},transition:{duration:.15},children:e.jsxDEV(qe,{conversation:k,selected:k.id===t,onCloseMobile:g?void 0:L,hideContextBadge:!0},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:418,columnNumber:21},this)},k.id,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:410,columnNumber:19},this))]},V.id,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:390,columnNumber:15},this)):M.map(V=>e.jsxDEV(S.div,{variants:{hidden:{opacity:0},visible:{opacity:1}},transition:{duration:.15},children:e.jsxDEV(qe,{conversation:V,selected:V.id===t,onCloseMobile:g?void 0:L,hideContextBadge:h==="division"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:439,columnNumber:17},this)},V.id,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:431,columnNumber:15},this))},`list-${h}-${w||"all"}`,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:377,columnNumber:9},this):Z()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:375,columnNumber:5},this),$=()=>e.jsxDEV("div",{className:"flex items-center justify-between px-4 min-h-[68px] border-b",children:[e.jsxDEV(Nn,{user:a},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:457,columnNumber:7},this),e.jsxDEV(G,{size:"icon",variant:"ghost",onClick:m,className:"rounded-full h-9 w-9",children:e.jsxDEV(cn,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:464,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:458,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:456,columnNumber:5},this),Q=()=>e.jsxDEV("div",{className:"px-3 py-2",children:e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(is,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground/60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:472,columnNumber:9},this),e.jsxDEV(ms,{value:v,onChange:V=>E(V.target.value),placeholder:"Search",className:"pl-10 h-9 rounded-full bg-muted/50 border-0 focus-visible:ring-0 text-sm","aria-label":"Search conversations"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:473,columnNumber:9},this),e.jsxDEV(X,{children:v&&e.jsxDEV(S.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},children:e.jsxDEV(G,{variant:"ghost",size:"sm",className:"absolute right-1.5 top-1/2 -translate-y-1/2 h-6 w-6 p-0 text-muted-foreground hover:text-foreground rounded-full",onClick:_,"aria-label":"Clear search",children:"Ã—"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:488,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:482,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:480,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:471,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:470,columnNumber:5},this),le=()=>e.jsxDEV("div",{className:"px-3 pb-2",children:e.jsxDEV("div",{className:"inline-flex items-center w-full rounded-lg bg-muted/60 p-1",children:[e.jsxDEV("button",{onClick:()=>f("all"),className:T("flex-1 inline-flex items-center justify-center gap-1.5 rounded-md px-2 py-1.5 text-xs font-medium transition-all",h==="all"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:["All",y.all>0&&e.jsxDEV("span",{className:T("text-[10px]",h==="all"?"text-muted-foreground":"text-muted-foreground/60"),children:y.all},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:518,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:507,columnNumber:9},this),e.jsxDEV("button",{onClick:()=>f("personal"),className:T("flex-1 inline-flex items-center justify-center gap-1.5 rounded-md px-2 py-1.5 text-xs font-medium transition-all",h==="personal"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsxDEV(Ee,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:535,columnNumber:11},this),"Personal",y.personal>0&&e.jsxDEV("span",{className:T("text-[10px]",h==="personal"?"text-muted-foreground":"text-muted-foreground/60"),children:y.personal},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:538,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:526,columnNumber:9},this),e.jsxDEV("button",{onClick:()=>f("division"),className:T("flex-1 inline-flex items-center justify-center gap-1.5 rounded-md px-2 py-1.5 text-xs font-medium transition-all",h==="division"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsxDEV(ze,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:555,columnNumber:11},this),"Division",y.division>0&&e.jsxDEV("span",{className:T("text-[10px]",h==="division"?"text-muted-foreground":"text-muted-foreground/60"),children:y.division},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:558,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:546,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:506,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:505,columnNumber:5},this),ne=()=>{if(h!=="division"||C.length===0)return null;const V=w?C.find(k=>k.id===w):null;return e.jsxDEV(S.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"px-3 pb-2",children:e.jsxDEV(Je,{value:w||"all",onValueChange:k=>c(k==="all"?null:k),children:[e.jsxDEV(es,{className:"w-full h-9 text-xs bg-muted/40 border-muted-foreground/20 hover:bg-muted/60 transition-colors",children:e.jsxDEV("div",{className:"flex items-center gap-2 w-full",children:[e.jsxDEV("span",{className:"truncate font-medium",children:V?V.name:"All Seasons"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:591,columnNumber:15},this),e.jsxDEV("span",{className:"ml-auto shrink-0 rounded-full bg-primary/10 text-primary px-1.5 py-0.5 text-[10px] font-medium",children:V?V.count:y.division},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:594,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:590,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:589,columnNumber:11},this),e.jsxDEV(ss,{align:"start",className:"w-[var(--radix-select-trigger-width)]",children:[e.jsxDEV(Ae,{value:"all",className:"cursor-pointer",children:e.jsxDEV("div",{className:"flex items-center justify-between w-full gap-3",children:[e.jsxDEV("span",{className:"font-medium",children:"All Seasons"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:602,columnNumber:17},this),e.jsxDEV("span",{className:"shrink-0 rounded-full bg-muted px-1.5 py-0.5 text-[10px] font-medium text-muted-foreground",children:y.division},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:603,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:601,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:600,columnNumber:13},this),C.map(k=>e.jsxDEV(Ae,{value:k.id,className:"cursor-pointer",children:e.jsxDEV("div",{className:"flex items-center justify-between w-full gap-3",children:[e.jsxDEV("span",{className:"truncate",children:k.name},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:611,columnNumber:19},this),e.jsxDEV("span",{className:"shrink-0 rounded-full bg-muted px-1.5 py-0.5 text-[10px] font-medium text-muted-foreground",children:k.count},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:612,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:610,columnNumber:17},this)},k.id,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:609,columnNumber:15},this))]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:599,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:585,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:578,columnNumber:7},this)},ie=()=>e.jsxDEV("div",{className:"h-full flex flex-col",children:[$(),Q(),le(),e.jsxDEV(X,{children:ne()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:636,columnNumber:7},this),e.jsxDEV("div",{className:"flex-1 overflow-hidden",ref:D,children:e.jsxDEV(be,{className:"h-full",children:s?P():j()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:642,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:641,columnNumber:7},this),e.jsxDEV(Cn,{open:r,onOpenChange:u,currentUserId:a==null?void 0:a.id,onThreadCreated:R,addThreadOptimistically:b},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:647,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:625,columnNumber:5},this);return e.jsxDEV(e.Fragment,{children:[!N&&!g&&O(),N||g?e.jsxDEV("div",{className:"h-full w-full flex flex-col",children:ie()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:663,columnNumber:9},this):e.jsxDEV(us,{open:x,onOpenChange:L,children:e.jsxDEV(hs,{side:"left",className:"p-0 border-r-0 w-[320px]",children:ie()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:668,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:667,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-nav.tsx",lineNumber:659,columnNumber:5},this)}function Tn({participants:s=[],conversation:a,onDetailsClick:n,onBack:t}){var A;const d=(a==null?void 0:a.type)==="group",l=s.find(u=>!u.isCurrentUser),g=u=>{const v=u.trim().split(" ");return v.length===1?v[0].slice(0,2).toUpperCase():v.slice(0,2).map(o=>o.charAt(0)).join("").toUpperCase()},b=u=>{switch(u){case"online":return"bg-green-500";case"away":return"bg-yellow-500";case"busy":return"bg-red-500";case"offline":default:return"bg-gray-400"}},N=u=>u?`Last seen ${ds(new Date(u),{addSuffix:!0})}`:"Last seen recently",x=((A=a==null?void 0:a.participants)==null?void 0:A.length)||s.length,p=((a==null?void 0:a.participants)||s).filter(u=>u.status==="online").length,L=e.jsxDEV("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(z,{className:"h-9 w-9 md:h-10 md:w-10",children:[e.jsxDEV(H,{src:(a==null?void 0:a.photoURL)||(a==null?void 0:a.avatarUrl),alt:(a==null?void 0:a.displayName)||"Group Chat"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:91,columnNumber:11},this),e.jsxDEV(q,{className:"text-sm bg-gradient-to-br from-brand-dark to-brand-light text-white font-semibold",children:g((a==null?void 0:a.displayName)||(a==null?void 0:a.name)||"Group")},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:95,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:90,columnNumber:9},this),p>0&&e.jsxDEV("div",{className:"absolute bottom-0 right-0 h-3 w-3 bg-green-500 rounded-full border-2 border-background"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:102,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:89,columnNumber:7},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("h3",{className:"text-sm md:text-[15px] font-semibold truncate",children:(a==null?void 0:a.displayName)||(a==null?void 0:a.name)||"Group Chat"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:108,columnNumber:9},this),e.jsxDEV("div",{className:"flex items-center gap-1 text-[10px] md:text-xs text-muted-foreground",children:[e.jsxDEV(Ne,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:112,columnNumber:11},this),e.jsxDEV("span",{children:[x," members",p>0&&e.jsxDEV("span",{className:"ml-1",children:["â€¢ ",p," online"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:116,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:113,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:111,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:107,columnNumber:7},this),e.jsxDEV(xe,{className:"h-4 w-4 text-muted-foreground/50 flex-shrink-0"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:125,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:87,columnNumber:5},this),r=e.jsxDEV("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(z,{className:"h-9 w-9 md:h-10 md:w-10",children:[e.jsxDEV(H,{src:(l==null?void 0:l.photoURL)||(l==null?void 0:l.avatarUrl)||(a==null?void 0:a.photoURL),alt:(l==null?void 0:l.name)||(l==null?void 0:l.displayName)||(a==null?void 0:a.displayName)||"User"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:134,columnNumber:11},this),e.jsxDEV(q,{children:((l==null?void 0:l.name)||(l==null?void 0:l.displayName)||(a==null?void 0:a.displayName)||"U").charAt(0).toUpperCase()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:138,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:133,columnNumber:9},this),e.jsxDEV("div",{className:T("absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-background",b(l==null?void 0:l.status))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:144,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:132,columnNumber:7},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("h3",{className:"text-sm md:text-[15px] font-semibold truncate",children:(l==null?void 0:l.name)||(l==null?void 0:l.displayName)||(a==null?void 0:a.displayName)||"Unknown User"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:152,columnNumber:9},this),e.jsxDEV("p",{className:"text-[10px] md:text-xs text-muted-foreground truncate",children:(l==null?void 0:l.status)==="offline"?N(l.lastActivity):e.jsxDEV("span",{className:"capitalize",children:(l==null?void 0:l.status)||"online"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:159,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:155,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:151,columnNumber:7},this),e.jsxDEV(xe,{className:"h-4 w-4 text-muted-foreground/50 flex-shrink-0"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:168,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:130,columnNumber:5},this);return e.jsxDEV("div",{className:"flex items-center gap-2 w-full",children:[t&&e.jsxDEV(S.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.2},className:"md:hidden",children:e.jsxDEV(G,{variant:"ghost",size:"icon",onClick:u=>{u.stopPropagation(),t()},className:"h-11 w-11 rounded-full flex-shrink-0","aria-label":"Back to conversations",children:e.jsxDEV(Qs,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:192,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:182,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:176,columnNumber:9},this),e.jsxDEV("div",{className:T("flex items-center gap-2 md:gap-3 flex-1 py-1 px-2 -mx-2 rounded-xl transition-colors",n&&"cursor-pointer hover:bg-muted/50 active:bg-muted/70"),onClick:n,role:n?"button":void 0,tabIndex:n?0:void 0,onKeyDown:n?u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),n())}:void 0,children:d?L:r},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:198,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-header-detail.tsx",lineNumber:173,columnNumber:5},this)}const ve=["#C23B22","#B84A32","#B5651D","#A0522D","#CC7722","#B8860B","#9B870C","#808000","#6B8E23","#556B2F","#228B22","#2E8B57","#20B2AA","#008B8B","#008080","#007B7F","#0077B6","#006D77","#4682B4","#4169E1","#3B5998","#483D8B","#6A5ACD","#7B68EE","#6B5B95","#8A2BE2","#9400D3","#9932CC","#8B008B","#A52A6A","#C71585","#DB2777","#E91E63","#DC143C","#B22234","#8B0000","#7C3238","#704214","#8B4513","#A0522D","#CD853F","#D2691E","#E07020","#E65100","#BF360C","#5D4037","#455A64","#37474F","#546E7A","#607D8B"],_n="#D97706",In=s=>{if(!s)return!1;const a=s.toUpperCase();return a==="ADMIN"||a==="SUPER_ADMIN"||a==="SUPERADMIN"},Rn=(s,a=!1)=>{if(a)return _n;if(!s)return ve[0];let n=0;for(let t=0;t<s.length;t++)n=s.charCodeAt(t)+((n<<5)-n);return ve[Math.abs(n)%ve.length]};function Fn({message:s,participants:a,currentUserId:n}){return i.useMemo(()=>{var p;const d=a.find(L=>L.id===s.senderId)||{firstName:"Unknown",avatarUrl:""},l=s.senderId===n,g=s.contentType==="image",b=s.senderId||d.id||"",N=In(d.role),x=Rn(b,N);return{me:l,senderDetails:{firstName:((p=d.displayName)==null?void 0:p.split(" ")[0])||d.firstName,avatarUrl:d.photoURL||d.avatarUrl,color:x},hasImage:g}},[s,a,n])}function Bn({message:s,senderDetails:a}){var M;const n=s.matchData,{firstName:t,avatarUrl:d}=a,l=s.createdAt,g=i.useMemo(()=>Ds(n==null?void 0:n.sportType),[n==null?void 0:n.sportType]),b=m=>{try{const E=new Date(m);return De(E,"d MMM yyyy")}catch{return m}},N=m=>m?m.includes(" - ")?m.split(" - ")[0].trim():m.trim():"12:00 PM",x=m=>{if(!m)return"TBD";if(m.includes("M"))return m;const[E,_]=m.split(":"),R=parseInt(E),O=R>=12?"PM":"AM";return`${R%12||12}:${_} ${O}`},p=(m,E)=>{const _=N(m),[R,O]=_.split(" "),[P,Z]=R.split(":").map(Number);let W=O==="PM"&&P!==12?P+12:P;O==="AM"&&P===12&&(W=0);const j=W*60+Z+E*60,$=Math.floor(j/60)%24,Q=j%60,le=$%12||12,ne=$>=12?"PM":"AM";return`${le}:${String(Q).padStart(2,"0")} ${ne}`},L=()=>{const m=n==null?void 0:n.fee,E=n==null?void 0:n.feeAmount;if(m==="FREE"||!m)return"Free";if(m==="SPLIT"&&E){const _=parseFloat(E),R=parseInt((n==null?void 0:n.numberOfPlayers)||"2",10);return`RM${R>0?(_/R).toFixed(2):"0.00"}/player`}return m==="FIXED"&&E?`RM${parseFloat(E).toFixed(2)}/player`:"Free"},r=()=>(n==null?void 0:n.matchType)==="SINGLES"||(n==null?void 0:n.numberOfPlayers)==="2"?"Singles":"Doubles",A=()=>(n==null?void 0:n.matchType)==="SINGLES"||(n==null?void 0:n.numberOfPlayers)==="2"?2:4,u=(n==null?void 0:n.participants)||[],v=u.filter(m=>m.invitationStatus==="ACCEPTED"||!m.invitationStatus),o=A(),h=n!=null&&n.time?N(n.time):"12:00 PM",f=x(h),w=p(h,(n==null?void 0:n.duration)||2),c=(n==null?void 0:n.isFriendly)||(n==null?void 0:n.isFriendlyRequest),D=r(),y=m=>{var E;return m.name?m.name:m.username?m.username:`User ${((E=m.userId)==null?void 0:E.slice(-6))||"???"}`},C=m=>{switch(m){case"ACCEPTED":return{icon:pe,color:"text-emerald-500",bg:"bg-emerald-50"};case"DECLINED":return{icon:Pe,color:"text-red-500",bg:"bg-red-50"};case"PENDING":return{icon:Ys,color:"text-amber-500",bg:"bg-amber-50"};default:return{icon:pe,color:"text-emerald-500",bg:"bg-emerald-50"}}};return e.jsxDEV("div",{className:"group flex gap-3 py-2 px-4 md:px-6",children:[e.jsxDEV(z,{className:"h-8 w-8 flex-shrink-0 mt-0.5 border border-border/50",children:[e.jsxDEV(H,{src:d,alt:t},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:155,columnNumber:9},this),e.jsxDEV(q,{className:"text-[11px] bg-muted font-medium text-muted-foreground",children:((M=t==null?void 0:t.charAt(0))==null?void 0:M.toUpperCase())||"?"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:156,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:154,columnNumber:7},this),e.jsxDEV("div",{className:"flex flex-col flex-1 min-w-0 max-w-[420px]",children:[e.jsxDEV("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsxDEV("span",{className:"text-[13px] text-muted-foreground",children:[e.jsxDEV("span",{className:"font-semibold text-foreground",children:t},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:165,columnNumber:13},this),c?" sent a friendly match request":" posted a league match"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:164,columnNumber:11},this),e.jsxDEV("span",{className:"text-[11px] text-muted-foreground/50 ml-auto tabular-nums",children:xs(new Date(l),{addSuffix:!0})},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:168,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:163,columnNumber:9},this),e.jsxDEV("div",{className:"rounded-xl border bg-card overflow-hidden shadow-[0_1px_2px_rgba(0,0,0,0.05),0_1px_4px_rgba(0,0,0,0.04)]",style:{borderColor:`${g.badgeColor}25`},children:[e.jsxDEV("div",{className:"px-3.5 py-2.5 flex items-center justify-between border-b border-border/40",children:[e.jsxDEV("span",{className:"font-semibold text-[13px] text-foreground",children:[D," ",c?"Friendly":"League Match"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:180,columnNumber:13},this),e.jsxDEV("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded-full",style:{backgroundColor:`${g.badgeColor}15`,color:g.badgeColor},children:g.label},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:183,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:179,columnNumber:11},this),e.jsxDEV("div",{className:"px-3.5 py-3 flex gap-4",children:[e.jsxDEV("div",{className:"flex-1 space-y-1.5",children:[e.jsxDEV("div",{className:"flex items-center gap-2 text-[12px] text-muted-foreground",children:[e.jsxDEV(Ce,{className:"h-3.5 w-3.5 flex-shrink-0 opacity-60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:199,columnNumber:17},this),e.jsxDEV("span",{className:"truncate",children:(n==null?void 0:n.location)||"TBD"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:200,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:198,columnNumber:15},this),e.jsxDEV("div",{className:"flex items-center gap-2 text-[12px] text-muted-foreground",children:[e.jsxDEV(Es,{className:"h-3.5 w-3.5 flex-shrink-0 opacity-60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:203,columnNumber:17},this),e.jsxDEV("span",{children:b(n==null?void 0:n.date)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:204,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:202,columnNumber:15},this),e.jsxDEV("div",{className:"flex items-center gap-2 text-[12px] text-muted-foreground",children:[e.jsxDEV(rs,{className:"h-3.5 w-3.5 flex-shrink-0 opacity-60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:207,columnNumber:17},this),e.jsxDEV("span",{children:[f," â€“ ",w]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:208,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:206,columnNumber:15},this),e.jsxDEV("div",{className:"flex items-center gap-2 text-[12px] text-muted-foreground",children:[e.jsxDEV(Hs,{className:"h-3.5 w-3.5 flex-shrink-0 opacity-60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:211,columnNumber:17},this),e.jsxDEV("span",{children:L()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:212,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:210,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:197,columnNumber:13},this),e.jsxDEV("div",{className:"flex flex-col items-end gap-1.5 shrink-0",children:[e.jsxDEV("div",{className:T("flex items-center gap-1 text-[10px] font-medium px-2 py-0.5 rounded",n!=null&&n.courtBooked?"bg-emerald-50 text-emerald-600":"bg-red-50 text-red-500"),children:[e.jsxDEV("span",{children:n!=null&&n.courtBooked?"Court booked":"No court"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:227,columnNumber:17},this),n!=null&&n.courtBooked?e.jsxDEV(pe,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:229,columnNumber:19},this):e.jsxDEV(Pe,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:231,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:219,columnNumber:15},this),(n==null?void 0:n.isFriendlyRequest)&&(n==null?void 0:n.requestStatus)&&e.jsxDEV("div",{className:T("flex items-center gap-1 text-[10px] font-medium px-2 py-0.5 rounded",n.requestStatus==="ACCEPTED"&&"bg-emerald-50 text-emerald-600",n.requestStatus==="DECLINED"&&"bg-red-50 text-red-500",n.requestStatus==="EXPIRED"&&"bg-gray-100 text-gray-500",n.requestStatus==="PENDING"&&"bg-amber-50 text-amber-600"),children:[n.requestStatus==="ACCEPTED"&&"Accepted",n.requestStatus==="DECLINED"&&"Declined",n.requestStatus==="EXPIRED"&&"Expired",n.requestStatus==="PENDING"&&"Pending"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:237,columnNumber:17},this),(n==null?void 0:n.status)&&n.status!=="SCHEDULED"&&e.jsxDEV("div",{className:T("text-[10px] font-medium px-2 py-0.5 rounded",n.status==="COMPLETED"&&"bg-blue-50 text-blue-600",n.status==="CANCELLED"&&"bg-gray-100 text-gray-500",n.status==="ONGOING"&&"bg-amber-50 text-amber-600"),children:n.status},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:255,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:217,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:195,columnNumber:11},this),e.jsxDEV("div",{className:"px-3.5 py-2.5 border-t border-border/40 bg-muted/20",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[e.jsxDEV("div",{className:"flex items-center gap-1.5 text-[11px] text-muted-foreground font-medium",children:[e.jsxDEV(Ne,{className:"h-3.5 w-3.5 opacity-60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:273,columnNumber:17},this),e.jsxDEV("span",{children:"Players"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:274,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:272,columnNumber:15},this),e.jsxDEV("span",{className:"text-[10px] text-muted-foreground tabular-nums",children:[v.length,"/",o]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:276,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:271,columnNumber:13},this),e.jsxDEV("div",{className:"space-y-1",children:[u.map((m,E)=>{const _=C(m.invitationStatus),R=_.icon;return e.jsxDEV("div",{className:"flex items-center gap-2 py-1 px-2 rounded-md bg-background/60",children:[e.jsxDEV(z,{className:"h-5 w-5 border border-border/30",children:[e.jsxDEV(H,{src:m.image,alt:y(m)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:291,columnNumber:23},this),e.jsxDEV(q,{className:"text-[8px] bg-muted font-medium",children:y(m).charAt(0).toUpperCase()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:292,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:290,columnNumber:21},this),e.jsxDEV("div",{className:"flex-1 min-w-0 flex items-center gap-1.5",children:[e.jsxDEV("span",{className:"text-[12px] font-medium text-foreground truncate",children:y(m)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:297,columnNumber:23},this),m.role==="CREATOR"&&e.jsxDEV("span",{className:"text-[9px] text-muted-foreground bg-muted px-1.5 py-0.5 rounded font-medium",children:"Host"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:301,columnNumber:25},this),m.team&&e.jsxDEV("span",{className:"text-[9px] text-muted-foreground",children:["T",m.team==="team1"?"1":"2"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:306,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:296,columnNumber:21},this),e.jsxDEV(R,{className:T("h-3.5 w-3.5",_.color)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:311,columnNumber:21},this)]},m.id||m.userId||E,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:286,columnNumber:19},this)}),u.length<o&&Array.from({length:o-u.length}).map((m,E)=>e.jsxDEV("div",{className:"flex items-center gap-2 py-1 px-2 rounded-md border border-dashed border-border/50",children:[e.jsxDEV("div",{className:"h-5 w-5 rounded-full bg-muted/50 flex items-center justify-center",children:e.jsxDEV(Ne,{className:"h-2.5 w-2.5 text-muted-foreground/40"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:324,columnNumber:23},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:323,columnNumber:21},this),e.jsxDEV("span",{className:"text-[11px] text-muted-foreground/50 italic",children:"Waiting for player..."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:326,columnNumber:21},this)]},`empty-${E}`,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:319,columnNumber:19},this))]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:281,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:270,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:174,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:161,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/match-message-card.tsx",lineNumber:152,columnNumber:5},this)}const $n=i.memo(Bn);function On({message:s,participants:a,showAvatar:n=!0,onOpenLightbox:t,onReply:d,onDelete:l}){var ne,ie,V,k,I;const{data:g}=ge(),b=g==null?void 0:g.user,[N,x]=i.useState(!1),[p,L]=i.useState(s.reactions||[]),[r,A]=i.useState(!1),{me:u,senderDetails:v,hasImage:o}=Fn({message:s,participants:a,currentUserId:(b==null?void 0:b.id)||""}),{firstName:h,avatarUrl:f,color:w}=v,c=s.content||s.body||"",D=s.createdAt,y=s.isDeleted||!1,C=i.useMemo(()=>{if(s.messageType==="MATCH"&&s.matchData){if(typeof s.matchData=="string")try{return JSON.parse(s.matchData)}catch{return null}return s.matchData}return s.matchData&&typeof s.matchData=="object"?s.matchData:null},[s.messageType,s.matchData]),M=C!==null,m=i.useMemo(()=>{const U=c||"";return U.length<=20&&!U.includes(`
`)},[c]),E=i.useMemo(()=>De(new Date(D),"HH:mm"),[D]);if(M&&!y)return e.jsxDEV($n,{message:{...s,matchData:C},senderDetails:v},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:106,columnNumber:7},this);const _=()=>{d&&!y&&d(s)},R=()=>{x(!0)},O=()=>{l&&l(s.id),x(!1)},P=U=>{L(B=>{const K=B.find(F=>F.emoji===U);return K?K.isSelected?K.count===1?B.filter(F=>F.emoji!==U):B.map(F=>F.emoji===U?{...F,count:F.count-1,isSelected:!1}:F):B.map(F=>F.emoji===U?{...F,count:F.count+1,isSelected:!0}:F):[...B,{emoji:U,count:1,isSelected:!0}]})},W=((ie=(ne=s.repliesTo)==null?void 0:ne.sender)==null?void 0:ie.id)===(b==null?void 0:b.id)?"You":((k=(V=s.repliesTo)==null?void 0:V.sender)==null?void 0:k.name)||"User",j=s.repliesTo&&e.jsxDEV("div",{className:T("mb-2 pb-2 text-xs border-b",u?"border-white/20":"border-border"),children:[e.jsxDEV("span",{className:T("font-medium",u?"text-white/80":"text-foreground/70"),children:W},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:170,columnNumber:7},this),e.jsxDEV("p",{className:T("line-clamp-2 mt-0.5",u?"text-white/60":"text-muted-foreground"),children:s.repliesTo.isDeleted?e.jsxDEV("span",{className:"italic flex items-center gap-1",children:[e.jsxDEV(we,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:186,columnNumber:13},this),"Message deleted"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:185,columnNumber:11},this):s.repliesTo.content},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:178,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:164,columnNumber:5},this),$=!u&&n&&e.jsxDEV("div",{className:"mb-1",children:e.jsxDEV("p",{className:"text-xs font-medium",style:{color:w},children:h},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:198,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:197,columnNumber:5},this),Q=y?e.jsxDEV("div",{className:T("flex items-center gap-2 px-4 py-2.5 italic text-sm",u?"rounded-[20px] rounded-br-[6px] bg-brand-light/40 text-white/70":"rounded-[20px] rounded-bl-[6px] bg-muted/40 text-muted-foreground"),children:[e.jsxDEV(we,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:212,columnNumber:7},this),e.jsxDEV("span",{children:"Message deleted"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:213,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:203,columnNumber:5},this):e.jsxDEV("div",{className:T("relative w-fit max-w-full transition-all duration-200",o?"p-0 bg-transparent rounded-2xl overflow-hidden":"px-4 py-2.5",u?["rounded-[20px] rounded-br-[6px]","bg-brand-light text-white"]:["rounded-[20px] rounded-bl-[6px]","bg-muted text-foreground"]),children:[j,o?e.jsxDEV(S.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},transition:{duration:.3},children:[e.jsxDEV("img",{src:c,alt:"attachment",width:400,height:220,className:"min-h-[220px] w-full object-cover rounded-2xl cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>t==null?void 0:t(c)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:241,columnNumber:11},this),e.jsxDEV("span",{className:T("text-[10px] block text-right mt-1.5 px-2",u?"text-white/60":"text-muted-foreground/60"),children:E},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:249,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:236,columnNumber:9},this):m?e.jsxDEV("div",{className:"flex items-end gap-2",children:[e.jsxDEV("p",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:c},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:259,columnNumber:11},this),e.jsxDEV("span",{className:T("text-[10px] whitespace-nowrap flex-shrink-0 -mb-0.5",u?"text-white/60":"text-muted-foreground/60"),children:E},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:262,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:258,columnNumber:9},this):e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:c},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:272,columnNumber:11},this),e.jsxDEV("span",{className:T("text-[10px] block text-right mt-1",u?"text-white/60":"text-muted-foreground/60"),children:E},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:275,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:271,columnNumber:9},this),e.jsxDEV(X,{children:p.length>0&&e.jsxDEV(S.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:4},className:"flex flex-wrap gap-1 mt-1.5 -mb-0.5",children:p.map(U=>e.jsxDEV(S.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>P(U.emoji),className:T("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-xs transition-colors duration-150",u?"bg-white/15 hover:bg-white/25":"bg-muted-foreground/10 hover:bg-muted-foreground/20",U.isSelected&&"ring-1 ring-current/30"),children:[e.jsxDEV("span",{children:U.emoji},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:307,columnNumber:17},this),e.jsxDEV("span",{className:"font-medium",children:U.count},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:308,columnNumber:17},this)]},U.emoji,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:294,columnNumber:15},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:287,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:285,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:216,columnNumber:5},this),le=e.jsxDEV(X,{children:r&&!y&&e.jsxDEV(S.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.1},className:T("absolute -top-8 z-10 flex items-center gap-0.5","bg-background/95 backdrop-blur-sm rounded-full px-1 py-0.5 shadow-md border",u?"right-0":"left-0"),children:[e.jsxDEV(G,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-muted rounded-full",onClick:_,title:"Reply to message",children:e.jsxDEV(an,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:339,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:332,columnNumber:11},this),u&&e.jsxDEV(G,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-destructive/10 hover:text-destructive rounded-full",onClick:R,title:"Delete message",children:e.jsxDEV(we,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:349,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:342,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:321,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:319,columnNumber:5},this);return e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:T("group flex gap-2 py-1 px-4 md:px-6",u?"flex-row-reverse":"flex-row",y&&"opacity-50"),onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),children:[!u&&n&&e.jsxDEV(z,{className:"h-8 w-8 flex-shrink-0 mt-auto mb-1",children:[e.jsxDEV(H,{src:f,alt:h},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:371,columnNumber:13},this),e.jsxDEV(q,{className:"text-xs font-medium text-white",style:{backgroundColor:w},children:((I=h==null?void 0:h.charAt(0))==null?void 0:I.toUpperCase())||"?"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:372,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:370,columnNumber:11},this),!u&&!n&&e.jsxDEV("div",{className:"w-8 flex-shrink-0"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:381,columnNumber:11},this),e.jsxDEV("div",{className:T("flex flex-col flex-1 min-w-0 max-w-[75%]",u?"items-end":"items-start"),children:[$,e.jsxDEV("div",{className:"relative",children:[le,Q]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:392,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:385,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:359,columnNumber:7},this),e.jsxDEV(Rs,{open:N,onOpenChange:x,children:e.jsxDEV(Fs,{children:[e.jsxDEV(Bs,{children:[e.jsxDEV($s,{children:"Delete Message"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:403,columnNumber:13},this),e.jsxDEV(Os,{children:"Are you sure you want to delete this message? This action cannot be undone."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:404,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:402,columnNumber:11},this),e.jsxDEV(Ps,{children:[e.jsxDEV(Gs,{children:"Cancel"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:410,columnNumber:13},this),e.jsxDEV(zs,{onClick:O,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:411,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:409,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:401,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:400,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-item.tsx",lineNumber:358,columnNumber:5},this)}const Pn=i.memo(On),Gn={initial:{y:0,opacity:.4},animate:s=>({y:[-1,1,-1],opacity:[.4,.8,.4],transition:{y:{duration:.6,repeat:1/0,ease:"easeInOut",delay:s*.12},opacity:{duration:.6,repeat:1/0,ease:"easeInOut",delay:s*.12}}})};function zn({threadId:s,members:a}){const{data:n}=ge(),t=n==null?void 0:n.user,{typingUsers:d}=bs(s,a),l=d.filter(b=>b.userId!==(t==null?void 0:t.id)),g=()=>l.length===1?`${l[0].userName} is typing`:l.length===2?`${l[0].userName} and ${l[1].userName} are typing`:`${l[0].userName} and ${l.length-1} others are typing`;return e.jsxDEV(X,{children:l.length>0&&e.jsxDEV(S.div,{initial:{opacity:0,y:8,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:8,height:0},transition:{duration:.2,ease:[.4,0,.2,1]},className:"px-4 py-2.5 overflow-hidden",children:e.jsxDEV("div",{className:"flex items-center gap-2.5",children:[e.jsxDEV("div",{className:"flex gap-0.5 items-center h-4",children:[0,1,2].map(b=>e.jsxDEV(S.div,{custom:b,variants:Gn,initial:"initial",animate:"animate",className:"w-1.5 h-1.5 bg-muted-foreground/60 rounded-full"},b,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/typing-indicator.tsx",lineNumber:67,columnNumber:17},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/typing-indicator.tsx",lineNumber:65,columnNumber:13},this),e.jsxDEV(S.span,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-sm text-muted-foreground/70",children:g()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/typing-indicator.tsx",lineNumber:77,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/typing-indicator.tsx",lineNumber:63,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/typing-indicator.tsx",lineNumber:56,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/typing-indicator.tsx",lineNumber:54,columnNumber:5},this)}const Hn=()=>e.jsxDEV("div",{className:"flex gap-3 px-4 py-2",children:[e.jsxDEV(te,{className:"h-8 w-8 rounded-full flex-shrink-0"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:39,columnNumber:5},void 0),e.jsxDEV("div",{className:"flex-1 space-y-2",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(te,{className:"h-3 w-16"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:42,columnNumber:9},void 0),e.jsxDEV(te,{className:"h-3 w-20"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:43,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:41,columnNumber:7},void 0),e.jsxDEV(te,{className:"h-4 w-48"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:45,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:40,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:38,columnNumber:3},void 0),qn=({date:s})=>{const a=new Date(s),n=()=>dn(a)?"Today":un(a)?"Yesterday":De(a,"MMMM d, yyyy");return e.jsxDEV("div",{className:"flex items-center justify-center py-3",children:e.jsxDEV("span",{className:"px-3 py-1 rounded-full bg-muted/60 text-xs font-medium text-muted-foreground",children:n()},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:61,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:60,columnNumber:5},void 0)};function Yn({messages:s=[],participants:a=[],loading:n=!1,threadId:t,onReply:d,onDelete:l}){const g=i.useRef(null),[b,N]=i.useState(!0),[x,p]=i.useState(!1),L=s.reduce((u,v)=>{const o=De(new Date(v.createdAt),"yyyy-MM-dd");return u[o]||(u[o]=[]),u[o].push(v),u},{});i.useEffect(()=>{if(b&&g.current){const u=g.current.querySelector("[data-radix-scroll-area-viewport]");u&&(u.scrollTop=u.scrollHeight)}},[s,b]);const r=u=>{const{scrollTop:v,scrollHeight:o,clientHeight:h}=u.currentTarget,f=o-v-h<100;N(f),p(!f&&s.length>10)},A=()=>{if(g.current){const u=g.current.querySelector("[data-radix-scroll-area-viewport]");u&&u.scrollTo({top:u.scrollHeight,behavior:"smooth"})}};return n&&s.length===0?e.jsxDEV("div",{className:"flex-1 overflow-hidden",children:e.jsxDEV("div",{className:"space-y-4 p-4",children:Array.from({length:5}).map((u,v)=>e.jsxDEV(Hn,{},v,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:123,columnNumber:13},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:121,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:120,columnNumber:7},this):s.length===0?e.jsxDEV("div",{className:"flex-1 flex items-center justify-center",children:e.jsxDEV(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.4,0,.2,1]},className:"text-center",children:[e.jsxDEV("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full bg-muted/50 flex items-center justify-center",children:e.jsxDEV(he,{className:"w-8 h-8 text-muted-foreground/50"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:140,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:139,columnNumber:11},this),e.jsxDEV("h3",{className:"text-lg font-medium text-foreground/80 mb-2",children:"Start a conversation"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:142,columnNumber:11},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground max-w-xs mx-auto",children:"Send a message to begin chatting"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:145,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:133,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:132,columnNumber:7},this):e.jsxDEV("div",{className:"flex-1 relative overflow-hidden bg-background",children:[e.jsxDEV(be,{ref:g,className:"h-full",onScrollCapture:r,children:e.jsxDEV("div",{className:"min-h-full flex flex-col justify-end py-2",children:[Object.entries(L).map(([u,v])=>e.jsxDEV("div",{children:[e.jsxDEV(qn,{date:v[0].createdAt},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:163,columnNumber:15},this),e.jsxDEV(X,{mode:"popLayout",children:v.map((o,h)=>{const f=h>0?v[h-1]:null,w=!f||f.senderId!==o.senderId;return e.jsxDEV(S.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{duration:.25,delay:h<3?h*.05:0,ease:[.4,0,.2,1]},layout:!0,children:e.jsxDEV(Pn,{message:o,participants:a,showAvatar:w,onReply:d,onDelete:l},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:182,columnNumber:23},this)},o.id,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:170,columnNumber:21},this)})},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:164,columnNumber:15},this)]},u,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:162,columnNumber:13},this)),e.jsxDEV(zn,{threadId:t,members:a},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:197,columnNumber:11},this),e.jsxDEV(X,{children:n&&e.jsxDEV(S.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"flex items-center justify-center py-4",children:[e.jsxDEV(cs,{className:"h-4 w-4 animate-spin mr-2"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:209,columnNumber:17},this),e.jsxDEV("span",{className:"text-sm text-muted-foreground",children:"Sending..."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:210,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:202,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:200,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:160,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:155,columnNumber:7},this),e.jsxDEV(X,{children:x&&e.jsxDEV(S.button,{initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:10},transition:{duration:.2,ease:"easeOut"},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:A,className:"absolute bottom-4 right-4 bg-primary text-primary-foreground rounded-full p-2.5 shadow-lg hover:bg-primary/90 transition-colors","aria-label":"Scroll to bottom",children:e.jsxDEV("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:237,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:231,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:220,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:218,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-list.tsx",lineNumber:154,columnNumber:5},this)}const Kn=i.lazy(()=>Cs(()=>import("./emoji-picker-react.esm-CsubU2Kf.js"),__vite__mapDeps([0,1,2]))),me=new Map;function Wn({selectedConversationId:s,disabled:a=!1,onSendMessage:n,replyingTo:t,onCancelReply:d}){var M;const[l,g]=i.useState(""),[b,N]=i.useState(!1),[x,p]=i.useState(!1),[L,r]=i.useState(!1),A=i.useRef(null),u=i.useRef(void 0),v=i.useRef(void 0),{setTyping:o}=bs(s);i.useEffect(()=>{const m=v.current;if(m&&m!==s&&(l.trim()?me.set(m,l):me.delete(m)),s&&s!==m){const E=me.get(s)||"";g(E),setTimeout(()=>{A.current&&(A.current.style.height="auto",A.current.style.height=`${Math.min(A.current.scrollHeight,120)}px`,A.current.focus())},0)}v.current=s},[s]),i.useEffect(()=>{s&&l.trim()?me.set(s,l):s&&!l.trim()&&me.delete(s)},[l,s]),i.useEffect(()=>{t&&A.current&&A.current.focus()},[t]);const h=i.useCallback(async()=>{if(!l.trim()||!n||b)return;const m=l.trim();g(""),N(!0),o(!1),s&&me.delete(s);try{await n(m),setTimeout(()=>{var E;(E=A.current)==null||E.focus()},0)}catch(E){console.error("Failed to send message:",E),g(m),s&&me.set(s,m)}finally{N(!1)}},[l,n,b,o,s]),f=i.useCallback(m=>{const E=m.metaKey||m.ctrlKey;if(E&&(m.key==="a"||m.key==="A")){m.stopPropagation();const _=m.currentTarget;_.setSelectionRange(0,_.value.length),m.preventDefault();return}if(E){m.stopPropagation();return}if(m.key==="Enter"&&!m.shiftKey){m.preventDefault(),h();return}if(m.key==="Escape"&&t&&d){m.preventDefault(),d();return}},[h,t,d]),w=i.useCallback(()=>{const m=A.current;m&&(m.style.height="auto",m.style.height=`${Math.min(m.scrollHeight,120)}px`)},[]),c=i.useCallback(m=>{const E=m.target.value;g(E),w(),E.trim()&&s?(o(!0),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{o(!1)},1e3)):o(!1)},[w,s,o]),D=i.useCallback(m=>{const E=m.emoji,_=A.current;if(_){const R=_.selectionStart,O=_.selectionEnd,P=l.slice(0,R)+E+l.slice(O);g(P),setTimeout(()=>{_.focus(),_.setSelectionRange(R+E.length,R+E.length)},0)}else g(R=>R+E);p(!1),w()},[l,w]);i.useEffect(()=>()=>{u.current&&clearTimeout(u.current),o(!1)},[s,o]);const y=a||!s||b,C=()=>{var m;return e.jsxDEV(X,{children:t&&e.jsxDEV(S.div,{initial:{opacity:0,y:20,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:20,height:0},transition:{duration:.25,ease:[.4,0,.2,1]},className:"border-t bg-muted/20 px-4 py-3 overflow-hidden",children:e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(S.div,{initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.2,delay:.1},className:"w-1 bg-primary rounded-full h-12 flex-shrink-0 mt-1 origin-top"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:249,columnNumber:15},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[e.jsxDEV("p",{className:"text-xs font-medium text-primary",children:["Replying to ",((m=t.sender)==null?void 0:m.name)||"User"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:258,columnNumber:19},this),e.jsxDEV(S.div,{whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsxDEV(G,{size:"sm",variant:"ghost",onClick:d,className:"h-6 w-6 p-0 flex-shrink-0 hover:bg-muted-foreground/20 rounded-full",children:e.jsxDEV(Vs,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:268,columnNumber:23},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:262,columnNumber:21},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:261,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:257,columnNumber:17},this),e.jsxDEV("div",{className:"bg-background/60 rounded-xl px-3 py-2 border border-border/50",children:e.jsxDEV("p",{className:"text-sm text-muted-foreground line-clamp-3",children:t.content||"Message"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:274,columnNumber:19},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:273,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:256,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:247,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:240,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:238,columnNumber:7},this)};return e.jsxDEV("div",{className:"bg-background",children:[C(),e.jsxDEV("div",{className:"border-t bg-background px-3 md:px-4 py-2 md:py-3",children:e.jsxDEV("div",{className:"flex items-end gap-2",children:[e.jsxDEV("div",{className:"flex-1 relative",children:[e.jsxDEV(Us,{ref:A,value:l,onChange:c,onKeyDown:f,onFocus:()=>r(!0),onBlur:()=>r(!1),placeholder:t?`Reply to ${((M=t.sender)==null?void 0:M.name)||"message"}...`:s?"Message":"Select a conversation",className:T("min-h-[44px] max-h-[120px] py-2.5 md:py-3 px-3 md:px-4 pr-10 md:pr-12","resize-none rounded-[22px]","bg-muted/50 border-0 focus:bg-muted","transition-colors focus-visible:ring-0 focus-visible:ring-offset-0","text-sm md:text-base"),disabled:y,rows:1},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:296,columnNumber:13},this),e.jsxDEV(Qe,{open:x,onOpenChange:p,children:[e.jsxDEV(Xe,{asChild:!0,children:e.jsxDEV(G,{variant:"ghost",size:"icon",className:"absolute right-2 bottom-1.5 h-8 w-8 rounded-full hover:bg-background/50",disabled:y,children:e.jsxDEV(ln,{className:"h-5 w-5 text-muted-foreground"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:330,columnNumber:19},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:324,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:323,columnNumber:15},this),e.jsxDEV(Ze,{className:"w-auto p-0 border-none shadow-lg",side:"top",align:"end",sideOffset:8,children:e.jsxDEV(S.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},transition:{duration:.2,ease:"easeOut"},children:e.jsxDEV(i.Suspense,{fallback:e.jsxDEV("div",{className:"w-80 h-96 flex items-center justify-center",children:"Loading..."},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:344,columnNumber:39},this),children:e.jsxDEV(Kn,{onEmojiClick:D,autoFocusSearch:!1,height:400,width:350,previewConfig:{showPreview:!1},skinTonesDisabled:!0,searchDisabled:!1},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:345,columnNumber:21},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:344,columnNumber:19},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:339,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:333,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:322,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:295,columnNumber:11},this),e.jsxDEV(S.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxDEV(G,{onClick:h,disabled:y||!l.trim(),size:"icon",className:T("h-11 w-11 rounded-full flex-shrink-0","bg-brand-light hover:bg-brand-light/90 text-white","disabled:opacity-40 disabled:cursor-not-allowed"),children:e.jsxDEV(js,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:377,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:367,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:363,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:293,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:292,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-message-input.tsx",lineNumber:287,columnNumber:5},this)}function ws(s){const[a,n]=i.useState(!0),t=i.useCallback(()=>{n(!0)},[]),d=i.useCallback(()=>{n(!1)},[]),l=i.useCallback(()=>{n(g=>!g)},[]);return{value:a,onTrue:t,onFalse:d,onToggle:l,setValue:n}}const Qn=s=>s.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().slice(0,2);function Xn({participant:s,onClose:a}){const n=re(),{data:t}=Ns((s==null?void 0:s.id)||""),d=(s==null?void 0:s.name)||(s==null?void 0:s.displayName)||"Unknown",l=(s==null?void 0:s.photoURL)||(s==null?void 0:s.avatarUrl),g=(s==null?void 0:s.role)||"Member",b=(s==null?void 0:s.status)||"offline",N=(s==null?void 0:s.email)||(t==null?void 0:t.email),x=t==null?void 0:t.area,p=()=>{s!=null&&s.id&&(n({to:"/players/$playerId",params:{playerId:s.id}}),a())};return e.jsxDEV("div",{className:"flex flex-col gap-4",children:[e.jsxDEV("div",{className:"flex items-start gap-4",children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(z,{className:"h-16 w-16",children:[e.jsxDEV(H,{src:l,alt:d},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:65,columnNumber:13},this),e.jsxDEV(q,{className:"text-lg",children:Qn(d)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:66,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:64,columnNumber:11},this),e.jsxDEV("div",{className:`absolute bottom-0 right-0 h-3.5 w-3.5 rounded-full border-2 border-background ${ae(b)}`},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:69,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:63,columnNumber:9},this),e.jsxDEV("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsxDEV("h4",{className:"text-base font-medium truncate",children:d},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:75,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxDEV(Ue,{variant:"secondary",className:"text-xs capitalize",children:g},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:77,columnNumber:13},this),e.jsxDEV("span",{className:"text-xs text-muted-foreground capitalize",children:b},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:80,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:76,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:74,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:62,columnNumber:7},this),e.jsxDEV("div",{className:"space-y-2 text-sm",children:[N&&e.jsxDEV("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsxDEV(gs,{className:"h-3.5 w-3.5 flex-shrink-0"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:89,columnNumber:13},this),e.jsxDEV("span",{className:"truncate",children:N},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:90,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:88,columnNumber:11},this),x&&e.jsxDEV("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsxDEV(Ce,{className:"h-3.5 w-3.5 flex-shrink-0"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:95,columnNumber:13},this),e.jsxDEV("span",{className:"truncate",children:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:96,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:94,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:86,columnNumber:7},this),e.jsxDEV(G,{variant:"outline",size:"sm",className:"w-full mt-1",onClick:p,disabled:!(s!=null&&s.id),children:[e.jsxDEV(fs,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:109,columnNumber:9},this),"View Profile"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:102,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-participant-dialog.tsx",lineNumber:60,columnNumber:5},this)}const Zn=s=>s.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().slice(0,2),Jn=s=>{const a=s.trim().split(" ");return a.length===1?a[0].slice(0,2).toUpperCase():a.slice(0,2).map(n=>n.charAt(0)).join("").toUpperCase()};function ea({participants:s,conversation:a}){const[n,t]=i.useState(null),d=ws(),l=i.useCallback(r=>{t(r)},[]),g=()=>t(null),b=s.length,N=s.filter(r=>r.status==="online").length,x=e.jsxDEV("div",{className:"flex flex-col items-center py-5 px-3 border-b border-border",children:[e.jsxDEV(z,{className:"h-20 w-20 mb-3",children:[e.jsxDEV(H,{src:(a==null?void 0:a.photoURL)||(a==null?void 0:a.avatarUrl),alt:(a==null?void 0:a.displayName)||"Group Chat"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:75,columnNumber:9},this),e.jsxDEV(q,{className:"text-lg bg-gradient-to-br from-brand-dark to-brand-light text-white font-semibold",children:Jn((a==null?void 0:a.displayName)||(a==null?void 0:a.name)||"Group")},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:79,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:74,columnNumber:7},this),e.jsxDEV("h3",{className:"text-lg font-semibold text-center mb-1",children:(a==null?void 0:a.displayName)||(a==null?void 0:a.name)||"Group Chat"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:87,columnNumber:7},this),e.jsxDEV("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsxDEV(Ne,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:93,columnNumber:9},this),e.jsxDEV("span",{children:[b," members",N>0&&e.jsxDEV("span",{className:"ml-1",children:["â€¢ ",N," online"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:97,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:94,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:92,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:72,columnNumber:5},this),p=e.jsxDEV(G,{variant:"ghost",onClick:d.onToggle,className:"flex items-center justify-between w-full h-10 px-3 text-xs font-medium text-muted-foreground bg-muted/50",children:[e.jsxDEV("span",{children:["Members (",b,")"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:110,columnNumber:7},this),d.value?e.jsxDEV(os,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:112,columnNumber:9},this):e.jsxDEV(xe,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:114,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:105,columnNumber:5},this),L=e.jsxDEV(be,{className:"h-[500px]",children:e.jsxDEV("ul",{className:"divide-y divide-border",children:s.map(r=>e.jsxDEV("li",{onClick:()=>l(r),className:"flex items-center gap-3 px-3 py-2.5 cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(z,{className:"h-8 w-8",children:[e.jsxDEV(H,{src:r.photoURL||r.avatarUrl,alt:r.name||r.displayName},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:130,columnNumber:17},this),e.jsxDEV(q,{children:Zn(r.name||r.displayName||"User")},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:134,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:129,columnNumber:15},this),e.jsxDEV("span",{className:T("absolute bottom-0 right-0 h-2.5 w-2.5 rounded-full border border-background",r.status==="online"?"bg-green-500":r.status==="offline"?"bg-gray-400":"bg-yellow-500")},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:139,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:128,columnNumber:13},this),e.jsxDEV("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:"text-sm font-medium truncate",children:r.name||r.displayName},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:153,columnNumber:17},this),r.isCurrentUser&&e.jsxDEV("span",{className:"text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-1.5 py-0.5 rounded-full",children:"You"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:157,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:152,columnNumber:15},this),e.jsxDEV("span",{className:"text-xs text-muted-foreground truncate",children:r.role||"Member"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:162,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:151,columnNumber:13},this)]},r.id,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:123,columnNumber:11},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:121,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:120,columnNumber:5},this);return e.jsxDEV(e.Fragment,{children:[x,p,e.jsxDEV("div",{className:T("transition-all overflow-hidden",d.value?"max-h-[500px]":"max-h-0"),children:d.value&&L},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:177,columnNumber:7},this),n&&e.jsxDEV(ns,{open:!!n,onOpenChange:g,children:e.jsxDEV(as,{className:"max-w-sm",children:[e.jsxDEV(ts,{children:e.jsxDEV(ls,{className:"sr-only",children:n.name||n.displayName},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:190,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:189,columnNumber:13},this),e.jsxDEV(Xn,{participant:n,onClose:g},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:194,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:188,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:187,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-group.tsx",lineNumber:173,columnNumber:5},this)}const sa=s=>s.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().slice(0,2);function na({participant:s,conversation:a}){const n=ws(),t=re(),{data:d}=Ns((s==null?void 0:s.id)||""),l=(s==null?void 0:s.name)||(s==null?void 0:s.displayName)||"Unknown User",g=(s==null?void 0:s.photoURL)||"unknown",b=(s==null?void 0:s.role)||"User",N=(s==null?void 0:s.email)||(d==null?void 0:d.email)||"No email provided",x=(s==null?void 0:s.status)||"offline",p=(d==null?void 0:d.sports)||[],L=d==null?void 0:d.area,r=d==null?void 0:d.lastLoginDate,A=()=>{s!=null&&s.id&&t({to:"/players/$playerId",params:{playerId:s.id}})},u=e.jsxDEV("div",{className:"flex flex-col items-center py-5 px-3 border-b border-border",children:[e.jsxDEV("div",{className:"relative mb-3",children:[e.jsxDEV(z,{className:"h-20 w-20",children:[e.jsxDEV(H,{src:g,alt:l},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:52,columnNumber:11},this),e.jsxDEV(q,{className:"text-lg",children:sa(l)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:53,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:51,columnNumber:9},this),e.jsxDEV("div",{className:T("absolute bottom-1 right-1 h-4 w-4 rounded-full border-2 border-background",ae(x))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:58,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:50,columnNumber:7},this),e.jsxDEV("h3",{className:"text-lg font-semibold text-center mb-1",children:l},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:64,columnNumber:7},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground mb-1 capitalize",children:x},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:65,columnNumber:7},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:b},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:66,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:49,columnNumber:5},this),v=e.jsxDEV(G,{variant:"ghost",onClick:n.onToggle,className:"flex items-center justify-between w-full h-10 px-3 text-xs font-medium text-muted-foreground bg-muted/50",children:[e.jsxDEV("span",{children:"Information"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:76,columnNumber:7},this),n.value?e.jsxDEV(os,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:78,columnNumber:9},this):e.jsxDEV(xe,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:80,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:71,columnNumber:5},this),o=e.jsxDEV("div",{className:T("overflow-hidden transition-all duration-200",n.value?"max-h-[400px]":"max-h-0"),children:e.jsxDEV("div",{className:"flex flex-col px-3 py-2.5 space-y-3 text-sm",children:[e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(Ee,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground mt-0.5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:95,columnNumber:11},this),e.jsxDEV("div",{className:"flex flex-col",children:[e.jsxDEV("span",{className:"text-xs text-muted-foreground",children:"Role"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:97,columnNumber:13},this),e.jsxDEV("span",{className:"text-sm",children:b},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:98,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:96,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:94,columnNumber:9},this),p.length>0&&e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(qs,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground mt-0.5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:105,columnNumber:13},this),e.jsxDEV("div",{className:"flex flex-col gap-1.5",children:[e.jsxDEV("span",{className:"text-xs text-muted-foreground",children:"Sports"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:107,columnNumber:15},this),e.jsxDEV("div",{className:"flex flex-wrap gap-1",children:p.map(h=>e.jsxDEV(Ue,{variant:"secondary",className:"text-xs capitalize",children:h},h,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:110,columnNumber:19},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:108,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:106,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:104,columnNumber:11},this),L&&e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(Ce,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground mt-0.5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:122,columnNumber:13},this),e.jsxDEV("div",{className:"flex flex-col",children:[e.jsxDEV("span",{className:"text-xs text-muted-foreground",children:"Location"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:124,columnNumber:15},this),e.jsxDEV("span",{className:"text-sm",children:L},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:125,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:123,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:121,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(gs,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground mt-0.5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:132,columnNumber:11},this),e.jsxDEV("div",{className:"flex flex-col min-w-0",children:[e.jsxDEV("span",{className:"text-xs text-muted-foreground",children:"Email"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:134,columnNumber:13},this),e.jsxDEV("span",{className:"text-sm truncate",children:N},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:135,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:133,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:131,columnNumber:9},this),r&&e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(rs,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground mt-0.5"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:142,columnNumber:13},this),e.jsxDEV("div",{className:"flex flex-col",children:[e.jsxDEV("span",{className:"text-xs text-muted-foreground",children:"Last Active"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:144,columnNumber:15},this),e.jsxDEV("span",{className:"text-sm",children:new Date(r).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:145,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:143,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:141,columnNumber:11},this),e.jsxDEV(G,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:A,disabled:!(s!=null&&s.id),children:[e.jsxDEV(fs,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:164,columnNumber:11},this),"View Profile"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:157,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:92,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:86,columnNumber:5},this);return e.jsxDEV("div",{children:[u,v,o]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-room-single.tsx",lineNumber:172,columnNumber:5},this)}function aa({open:s,onOpenChange:a,conversation:n,participants:t}){if(!n)return null;const d=n.type==="group";return e.jsxDEV(us,{open:s,onOpenChange:a,children:e.jsxDEV(hs,{side:"right",className:"w-[380px] p-0 overflow-y-auto",children:[e.jsxDEV(_s,{className:"sr-only",children:e.jsxDEV(Is,{children:d?"Group Details":"Contact Details"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-details-sheet.tsx",lineNumber:28,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-details-sheet.tsx",lineNumber:27,columnNumber:9},this),e.jsxDEV("div",{className:"flex flex-col h-full",children:d?e.jsxDEV(ea,{participants:t,conversation:n},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-details-sheet.tsx",lineNumber:35,columnNumber:13},this):e.jsxDEV(na,{participant:t.find(l=>!l.isCurrentUser),conversation:n},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-details-sheet.tsx",lineNumber:40,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-details-sheet.tsx",lineNumber:33,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-details-sheet.tsx",lineNumber:26,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/chat/chat-details-sheet.tsx",lineNumber:25,columnNumber:5},this)}function La(){const s=re(),{id:a}=ks({from:"/_authenticated/chat/"}),{data:n}=ge(),t=n==null?void 0:n.user,[d,l]=i.useState(null),[g,b]=i.useState(!1),{threads:N,loading:x,error:p,refetch:L,updateThreadLastMessage:r,markThreadAsRead:A}=vn(t==null?void 0:t.id,a),u=i.useCallback(async()=>{await L()},[L]),{messages:v,loading:o,sendMessage:h,deleteMessage:f,error:w}=An(a||void 0);i.useEffect(()=>{p&&(console.error("Threads error:",p),Y.error("Failed to load conversations")),w&&(console.error("Messages error:",w),Y.error("Failed to load messages"))},[p,w]),i.useEffect(()=>{l(null)},[a]),i.useEffect(()=>{a&&(t!=null&&t.id)&&A(a)},[a,t==null?void 0:t.id,A]);const c=i.useMemo(()=>N.map(j=>{var V,k,I;const $=j.isGroup?j.name||"Unnamed Group":j.members.filter(U=>U.userId!==(t==null?void 0:t.id)).map(U=>U.user.name).join(", ")||"Unknown",Q=j.isGroup?j.avatarUrl:(V=j.members.find(U=>U.userId!==(t==null?void 0:t.id)))==null?void 0:V.user.image,le=j.members.map(U=>({id:U.userId,name:U.user.name,username:U.user.username,email:U.user.email,phoneNumber:U.user.phoneNumber,image:U.user.image,displayName:U.user.name,photoURL:U.user.image,status:"online",role:U.role,isCurrentUser:U.userId===(t==null?void 0:t.id)})),ne=j.messages.length>0?{content:j.messages[0].content,createdAt:j.messages[0].createdAt,senderId:j.messages[0].senderId,sender:{id:(k=j.messages[0].sender)==null?void 0:k.id,name:j.messages[0].sender.name,image:(I=j.messages[0].sender)==null?void 0:I.image},messageType:j.messages[0].messageType,matchData:j.messages[0].matchData}:null,ie=j.division?{name:j.division.name,season:j.division.season?{id:j.division.season.id,name:j.division.season.name}:void 0,league:j.division.league?{name:j.division.league.name,sportType:j.division.league.sportType}:void 0}:void 0;return{id:j.id,type:j.isGroup?"group":"direct",displayName:$,name:j.name,photoURL:Q,avatarUrl:j.avatarUrl,isGroup:j.isGroup,participants:le,messages:[],lastMessage:ne,unreadCount:j.unreadCount??0,divisionId:j.divisionId,division:ie}}),[N,t==null?void 0:t.id]),D=a?c.find(j=>j.id===a):null,y=(D==null?void 0:D.participants)||[];i.useEffect(()=>{b(!1)},[a]);const C=i.useCallback(()=>{b(!0)},[]),M=i.useCallback(j=>{l(j)},[]),m=i.useCallback(()=>{l(null)},[]),E=i.useCallback(async j=>{if(!f){Y.error("Delete functionality not available");return}try{await f(j),Y.success("Message deleted successfully")}catch($){console.error("Failed to delete message:",$)}},[f]),_=i.useCallback(async j=>{if(!(t!=null&&t.id)||!a){Y.error("Unable to send message. Please select a conversation.");return}try{const $=await h(j,t.id,d==null?void 0:d.id);l(null),$&&r(a,$)}catch($){console.error("Failed to send message:",$),Y.error("Failed to send message. Please try again.")}},[h,t==null?void 0:t.id,a,d,r]),R=i.useCallback(j=>{s({to:"/chat",search:{id:j}})},[s]),O=i.useCallback(()=>{s({to:"/chat",search:{id:""}})},[s]);if(x&&N.length===0)return e.jsxDEV("div",{className:"absolute inset-0 flex flex-col",children:[e.jsxDEV(Re,{},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:188,columnNumber:9},this),e.jsxDEV("div",{className:"flex-1 flex items-center justify-center bg-gradient-to-b from-background to-muted/20",children:e.jsxDEV(S.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.32,.72,0,1]},className:"flex flex-col items-center gap-5",children:[e.jsxDEV("div",{className:"relative w-20 h-20",children:[e.jsxDEV(S.div,{initial:{scale:.8},animate:{scale:1},transition:{duration:.5,ease:"easeOut"},className:"absolute inset-0 rounded-2xl bg-gradient-to-br from-brand-light to-brand-dark flex items-center justify-center shadow-lg shadow-brand-light/20",children:e.jsxDEV(he,{className:"w-9 h-9 text-white"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:211,columnNumber:17},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:203,columnNumber:15},this),e.jsxDEV(S.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},className:"absolute -inset-3 rounded-full border-2 border-dashed border-brand-light/20"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:215,columnNumber:15},this),e.jsxDEV(S.div,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},className:"absolute -top-1 -right-1 w-4 h-4 rounded-full bg-brand-light/80"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:224,columnNumber:15},this),e.jsxDEV(S.div,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut",delay:.3},className:"absolute -bottom-1 -left-1 w-3 h-3 rounded-full bg-brand-dark/60"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:232,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:201,columnNumber:13},this),e.jsxDEV("div",{className:"text-center space-y-1",children:[e.jsxDEV(S.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-sm font-medium text-foreground",children:"Loading conversations"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:245,columnNumber:15},this),e.jsxDEV(S.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"flex items-center justify-center gap-1",children:[0,1,2].map(j=>e.jsxDEV(S.span,{animate:{opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:j*.2},className:"w-1.5 h-1.5 rounded-full bg-muted-foreground"},j,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:261,columnNumber:37},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:254,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:244,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:190,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:189,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:187,columnNumber:12},this);const P=()=>e.jsxDEV(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.32,.72,0,1]},className:"flex-1 flex items-center justify-center px-4 md:px-8",children:e.jsxDEV("div",{className:"text-center max-w-sm",children:[e.jsxDEV("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-muted/50 flex items-center justify-center",children:e.jsxDEV(he,{className:"w-10 h-10 text-muted-foreground/40"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:286,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:285,columnNumber:9},this),e.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold text-foreground mb-2",children:"No conversation selected"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:288,columnNumber:9},this),e.jsxDEV("p",{className:"text-xs md:text-sm text-muted-foreground",children:"Choose a chat from the sidebar to start messaging"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:291,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:284,columnNumber:7},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:274,columnNumber:34},this),Z=()=>e.jsxDEV("div",{className:"flex items-center px-3 md:px-4 py-2 md:py-3 min-h-[60px] md:min-h-[68px] border-b bg-background sticky top-0 z-10",children:a&&D?e.jsxDEV(Tn,{participants:y,conversation:D,onDetailsClick:C,onBack:O},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:297,columnNumber:56},this):e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("div",{className:"w-10 h-10 rounded-full bg-muted/50 flex items-center justify-center",children:e.jsxDEV(he,{className:"w-5 h-5 text-muted-foreground"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:299,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:298,columnNumber:11},this),e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"text-[15px] font-semibold",children:"Messages"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:302,columnNumber:13},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:[c.length," conversation",c.length!==1?"s":""]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:303,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:301,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:297,columnNumber:212},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:296,columnNumber:30},this),W=()=>!a||!D?P():e.jsxDEV("div",{className:"flex flex-col w-full h-full overflow-hidden",children:[e.jsxDEV(Yn,{messages:v,participants:y,loading:o,threadId:a,onReply:M,onDelete:E},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:314,columnNumber:9},this),e.jsxDEV(Wn,{selectedConversationId:a,disabled:!a||o,onSendMessage:_,replyingTo:d,onCancelReply:m},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:316,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:313,columnNumber:12},this);return e.jsxDEV("div",{className:"absolute inset-0 flex flex-col",children:[e.jsxDEV(Re,{},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:320,columnNumber:7},this),e.jsxDEV("div",{className:"flex-1 flex min-h-0",children:[e.jsxDEV("div",{className:"hidden md:block md:w-[360px] flex-shrink-0 border-r border-border/40 bg-background overflow-y-auto",children:e.jsxDEV(Ye,{conversations:c,loading:x,selectedConversationId:a,user:t,onConversationSelect:R,onThreadCreated:u},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:324,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:323,columnNumber:9},this),e.jsxDEV("div",{className:"flex-1 flex flex-col min-w-0 min-h-0 bg-background",children:[e.jsxDEV(X,{mode:"wait",children:a?e.jsxDEV(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:[.32,.72,0,1]},className:"flex-1 flex flex-col min-h-0 md:hidden",children:[Z(),W()]},a,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:349,columnNumber:11},this):e.jsxDEV(S.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2,ease:[.32,.72,0,1]},className:"flex-1 flex flex-col min-h-0 md:hidden",children:e.jsxDEV(Ye,{conversations:c,loading:x,selectedConversationId:a,user:t,onConversationSelect:R,onThreadCreated:u,forceMobileList:!0},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:346,columnNumber:17},this)},"conversation-list",!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:333,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:330,columnNumber:11},this),e.jsxDEV("div",{className:"hidden md:flex flex-1 flex flex-col min-h-0",children:e.jsxDEV(X,{mode:"wait",children:e.jsxDEV(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:[.32,.72,0,1]},className:"flex-1 flex flex-col min-h-0",children:[Z(),W()]},a||"empty",!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:370,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:369,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:368,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:329,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:321,columnNumber:7},this),e.jsxDEV(aa,{open:g,onOpenChange:b,conversation:D,participants:y},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:391,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/chat/index.tsx?tsr-split=component",lineNumber:319,columnNumber:10},this)}export{La as component};
