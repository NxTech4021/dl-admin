import{Y as M,r as I,j as t,B as k,an as C}from"./index-DjATwhQs.js";import{D as T,a as R,b as F,f as E}from"./dropdown-menu-C8Edz3DL.js";import{I as V}from"./IconDownload-CxLZ6q0K.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M8 11h8v7h-8z",key:"svg-2"}],["path",{d:"M8 15h8",key:"svg-3"}],["path",{d:"M11 11v7",key:"svg-4"}]],B=M("outline","file-spreadsheet","FileSpreadsheet",_);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M9 9l1 0",key:"svg-2"}],["path",{d:"M9 13l6 0",key:"svg-3"}],["path",{d:"M9 17l6 0",key:"svg-4"}]],U=M("outline","file-text","FileText",O);function w(e,n){return n.split(".").reduce((o,a)=>{if(o&&typeof o=="object")return o[a]},e)}function W(e,n){const o=n.map(l=>`"${l.header.replace(/"/g,'""')}"`).join(","),a=e.map(l=>n.map(s=>{const r=w(l,s.key),i=s.formatter?s.formatter(r,l):r;return i==null?'""':`"${String(i).replace(/"/g,'""')}"`}).join(","));return[o,...a].join(`
`)}function z(e,n,o){const a=o.replace(/[^a-zA-Z0-9]/g,"_").substring(0,31),l=n.map(r=>`<Cell ss:StyleID="header"><Data ss:Type="String">${S(r.header)}</Data></Cell>`).join(""),s=e.map(r=>`<Row>${n.map(m=>{const d=w(r,m.key),c=m.formatter?m.formatter(d,r):d;if(c==null)return'<Cell><Data ss:Type="String"></Data></Cell>';const g=typeof c=="number"&&!isNaN(c)?"Number":"String",f=String(c);return`<Cell><Data ss:Type="${g}">${S(f)}</Data></Cell>`}).join("")}</Row>`).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <Styles>
    <Style ss:ID="header">
      <Font ss:Bold="1"/>
      <Interior ss:Color="#CCCCCC" ss:Pattern="Solid"/>
    </Style>
  </Styles>
  <Worksheet ss:Name="${a}">
    <Table>
      <Row>${l}</Row>
      ${s}
    </Table>
  </Worksheet>
</Workbook>`}function S(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function D(e,n,o){const a=new Blob([e],{type:o}),l=URL.createObjectURL(a),s=document.createElement("a");s.href=l,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)}function P({data:e,columns:n,filename:o="export",formats:a=["csv","excel"],disabled:l=!1,onExportStart:s,onExportComplete:r,onExportError:i,className:m,variant:d="outline",size:c="default"}){const[h,g]=I.useState(!1),f=async u=>{if(e.length===0){i==null||i(new Error("No data to export"));return}g(!0),s==null||s();try{const b=new Date().toISOString().split("T")[0],N=`${o}_${b}`;switch(u){case"csv":{const p=W(e,n);D(p,`${N}.csv`,"text/csv;charset=utf-8");break}case"excel":{const p=z(e,n,o);D(p,`${N}.xls`,"application/vnd.ms-excel");break}case"json":{const p=e.map(y=>{const L={};return n.forEach(x=>{const j=w(y,x.key);L[x.header]=x.formatter?x.formatter(j,y):j}),L}),A=JSON.stringify(p,null,2);D(A,`${N}.json`,"application/json");break}}r==null||r(u)}catch(b){i==null||i(b instanceof Error?b:new Error("Export failed"))}finally{g(!1)}},$={csv:t.jsxDEV(U,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:200,columnNumber:10},this),excel:t.jsxDEV(B,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:201,columnNumber:12},this),json:t.jsxDEV(U,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:202,columnNumber:11},this)},v={csv:"Export as CSV",excel:"Export as Excel",json:"Export as JSON"};return a.length===1?t.jsxDEV(k,{variant:d,size:c,className:m,disabled:l||h||e.length===0,onClick:()=>f(a[0]),children:[h?t.jsxDEV(C,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:222,columnNumber:11},this):t.jsxDEV(V,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:224,columnNumber:11},this),v[a[0]]]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:214,columnNumber:7},this):t.jsxDEV(T,{children:[t.jsxDEV(R,{asChild:!0,children:t.jsxDEV(k,{variant:d,size:c,className:m,disabled:l||h||e.length===0,children:[h?t.jsxDEV(C,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:242,columnNumber:13},this):t.jsxDEV(V,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:244,columnNumber:13},this),"Export"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:235,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:234,columnNumber:7},this),t.jsxDEV(F,{align:"end",children:a.map(u=>t.jsxDEV(E,{onClick:()=>f(u),children:[$[u],v[u]]},u,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:251,columnNumber:11},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:249,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:233,columnNumber:5},this)}export{P as E};
