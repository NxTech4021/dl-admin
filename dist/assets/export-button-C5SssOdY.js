import{Y as I,r as M,j as t,B as k,ar as C}from"./index-BBfLVePp.js";import{D as R,a as T,b as E,f as F}from"./dropdown-menu-DE8Qz5Cb.js";import{I as V}from"./IconDownload-uJJlLxt3.js";import{I as U}from"./IconFileText-B_58U3Xh.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M8 11h8v7h-8z",key:"svg-2"}],["path",{d:"M8 15h8",key:"svg-3"}],["path",{d:"M11 11v7",key:"svg-4"}]],O=I("outline","file-spreadsheet","FileSpreadsheet",B);function w(e,n){return n.split(".").reduce((o,a)=>{if(o&&typeof o=="object")return o[a]},e)}function W(e,n){const o=n.map(r=>`"${r.header.replace(/"/g,'""')}"`).join(","),a=e.map(r=>n.map(s=>{const l=w(r,s.key),i=s.formatter?s.formatter(l,r):l;return i==null?'""':`"${String(i).replace(/"/g,'""')}"`}).join(","));return[o,...a].join(`
`)}function _(e,n,o){const a=o.replace(/[^a-zA-Z0-9]/g,"_").substring(0,31),r=n.map(l=>`<Cell ss:StyleID="header"><Data ss:Type="String">${S(l.header)}</Data></Cell>`).join(""),s=e.map(l=>`<Row>${n.map(m=>{const d=w(l,m.key),c=m.formatter?m.formatter(d,l):d;if(c==null)return'<Cell><Data ss:Type="String"></Data></Cell>';const f=typeof c=="number"&&!isNaN(c)?"Number":"String",b=String(c);return`<Cell><Data ss:Type="${f}">${S(b)}</Data></Cell>`}).join("")}</Row>`).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <Styles>
    <Style ss:ID="header">
      <Font ss:Bold="1"/>
      <Interior ss:Color="#CCCCCC" ss:Pattern="Solid"/>
    </Style>
  </Styles>
  <Worksheet ss:Name="${a}">
    <Table>
      <Row>${r}</Row>
      ${s}
    </Table>
  </Worksheet>
</Workbook>`}function S(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function D(e,n,o){const a=new Blob([e],{type:o}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}function P({data:e,columns:n,filename:o="export",formats:a=["csv","excel"],disabled:r=!1,onExportStart:s,onExportComplete:l,onExportError:i,className:m,variant:d="outline",size:c="default"}){const[h,f]=M.useState(!1),b=async u=>{if(e.length===0){i==null||i(new Error("No data to export"));return}f(!0),s==null||s();try{const g=new Date().toISOString().split("T")[0],x=`${o}_${g}`;switch(u){case"csv":{const p=W(e,n);D(p,`${x}.csv`,"text/csv;charset=utf-8");break}case"excel":{const p=_(e,n,o);D(p,`${x}.xls`,"application/vnd.ms-excel");break}case"json":{const p=e.map(v=>{const L={};return n.forEach(N=>{const j=w(v,N.key);L[N.header]=N.formatter?N.formatter(j,v):j}),L}),$=JSON.stringify(p,null,2);D($,`${x}.json`,"application/json");break}}l==null||l(u)}catch(g){i==null||i(g instanceof Error?g:new Error("Export failed"))}finally{f(!1)}},A={csv:t.jsxDEV(U,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:200,columnNumber:10},this),excel:t.jsxDEV(O,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:201,columnNumber:12},this),json:t.jsxDEV(U,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:202,columnNumber:11},this)},y={csv:"Export as CSV",excel:"Export as Excel",json:"Export as JSON"};return a.length===1?t.jsxDEV(k,{variant:d,size:c,className:m,disabled:r||h||e.length===0,onClick:()=>b(a[0]),children:[h?t.jsxDEV(C,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:222,columnNumber:11},this):t.jsxDEV(V,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:224,columnNumber:11},this),y[a[0]]]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:214,columnNumber:7},this):t.jsxDEV(R,{children:[t.jsxDEV(T,{asChild:!0,children:t.jsxDEV(k,{variant:d,size:c,className:m,disabled:r||h||e.length===0,children:[h?t.jsxDEV(C,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:242,columnNumber:13},this):t.jsxDEV(V,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:244,columnNumber:13},this),"Export"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:235,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:234,columnNumber:7},this),t.jsxDEV(E,{align:"end",children:a.map(u=>t.jsxDEV(F,{onClick:()=>b(u),children:[A[u],y[u]]},u,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:251,columnNumber:11},this))},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:249,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/components/shared/export-button.tsx",lineNumber:233,columnNumber:5},this)}export{P as E};
