const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/seasons-data-table-DShWQxvj.js","assets/index-PaEnrh4h.js","assets/index-D_fokOFx.css","assets/animation-variants-Don9j8OV.js","assets/alert-dialog-Bk9qRBfX.js","assets/table-DHgEGL6c.js","assets/use-notifications-C-JuzTac.js","assets/skeleton-CDI8_hIe.js","assets/sports-DMCIf8M6.js","assets/dropdown-menu-BkZ0tWmG.js","assets/index-C90KS6RS.js","assets/IconDotsVertical-D-6C6rNu.js","assets/IconEye-CGuf6U-F.js","assets/site-header-DRCY3qyo.js","assets/IconEdit-Bi9Gfxzg.js","assets/IconCopy-D9HmRRyn.js","assets/constants-DiLdiRGg.js","assets/IconHash-DeGz5kbL.js","assets/IconChevronRight-CkWZtI5A.js","assets/IconCurrencyDollar-D84AVHE8.js","assets/IconClock-DumkZ1VD.js","assets/season-edit-modal-D-lYOFgI.js","assets/IconChevronLeft-DeMdJF37.js"])))=>i.map(i=>d[i]);
import{Y as $,aa as g,r as c,u as q,k as Y,l as H,t as C,j as s,ab as Q,E as G,B as y,ac as K}from"./index-PaEnrh4h.js";import{S as Z,c as J,I as W}from"./site-header-DRCY3qyo.js";import{P as X}from"./page-header-Dwgyc6Et.js";import{S as D}from"./stats-card-DWiqSP0S.js";import{s as ee}from"./season-schema-dMIaplAQ.js";import{z as R}from"./external-DDvK8H97.js";import{A as se,a as N,b as te,d as ae}from"./animated-container-DDc1g4zA.js";import{S as ne}from"./search-input-CWMUnlRx.js";import{F as I}from"./filter-select-BzBFV-uZ.js";import{I as ie}from"./IconStar-DgvNdQ1H.js";import{I as oe}from"./IconDownload-BKXfYGv9.js";import"./use-notifications-C-JuzTac.js";import"./skeleton-CDI8_hIe.js";import"./coerce-CvkOk2G_.js";import"./animation-variants-Don9j8OV.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M12 12m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M4 4l3 3",key:"svg-1"}],["path",{d:"M20 4l-3 3",key:"svg-2"}],["path",{d:"M4 20l3 -3",key:"svg-3"}],["path",{d:"M20 20l-3 -3",key:"svg-4"}]],le=$("outline","currency","Currency",re),ce=[{value:"TENNIS",label:"Tennis"},{value:"PICKLEBALL",label:"Pickleball"},{value:"PADEL",label:"Padel"}],de=c.lazy(()=>K(()=>import("./seasons-data-table-DShWQxvj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])).then(o=>({default:o.SeasonsDataTable})));function Ee(){const[o,f]=g.useState([]),[m,A]=g.useState(!0),[h,r]=g.useState(null),[b,E]=c.useState(""),[v,S]=c.useState(void 0),[w,_]=c.useState(void 0),k=q(),j=c.useMemo(()=>{const n=new Map;return o.forEach(t=>{var e;(e=t.leagues)==null||e.forEach(i=>{i.id&&i.name&&n.set(i.id,i.name)})}),Array.from(n.entries()).map(([t,e])=>({value:t,label:e})).sort((t,e)=>t.label.localeCompare(e.label))},[o]),F=b||v||w,P=c.useCallback(()=>{E(""),S(void 0),_(void 0)},[]),l=g.useCallback(async()=>{var n,t;A(!0),r(null);try{const e=await Y.get(H.season.getAll);let i=[];if(Array.isArray(e.data)?i=e.data:(n=e.data)!=null&&n.data&&Array.isArray(e.data.data)?i=e.data.data:(t=e.data)!=null&&t.seasons&&Array.isArray(e.data.seasons)&&(i=e.data.seasons),!i||i.length===0){f([]);return}const d=R.array(ee).parse(i);f(d),r(null)}catch(e){console.error("Failed to fetch seasons:",e),e instanceof R.ZodError?(r("Invalid data format"),console.error("Validation errors:",e.issues)):e instanceof Error?e.message.includes("Network Error")?r("Network error"):e.message.includes("timeout")?r("Request timeout"):e.message.includes("401")||e.message.includes("403")?r("Access denied"):r("Failed to load"):r("Unexpected error"),f([])}finally{A(!1)}},[]);g.useEffect(()=>{l()},[l]);const T=n=>{k({to:"/seasons/$seasonId",params:{seasonId:n}})},M=c.useCallback(()=>{if(o.length===0){C.error("No data to export");return}const n=["Name","Status","Sport Type","Category","Entry Fee","Players","Divisions","Start Date","End Date","Deadline","Payment Required","Created At"],t=o.map(a=>{var x,V;return[a.name,a.status||"",a.sportType||"",((x=a.category)==null?void 0:x.name)||"No category",a.entryFee||0,a.registeredUserCount||0,((V=a.divisions)==null?void 0:V.length)||0,a.startDate?new Date(a.startDate).toLocaleDateString():"",a.endDate?new Date(a.endDate).toLocaleDateString():"",a.regiDeadline?new Date(a.regiDeadline).toLocaleDateString():"",a.paymentRequired?"Yes":"No",a.createdAt]}),e=[n.join(","),...t.map(a=>a.map(x=>`"${String(x).replace(/"/g,'""')}"`).join(","))].join(`
`),i=new Blob([e],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(i),p=document.createElement("a");p.href=d,p.download=`seasons-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(d),C.success("Seasons exported successfully")},[o]),u=o,L=u.length,O=u.filter(n=>n.status==="ACTIVE").length,U=u.reduce((n,t)=>{var e;return n+(((e=t.memberships)==null?void 0:e.length)||0)},0),z=u.reduce((n,t)=>{var d;const e=parseFloat((t==null?void 0:t.entryFee)||"0")||0,i=((d=t.memberships)==null?void 0:d.length)||0;return n+e*i},0),B=L>0?Math.round(U/L):0;return s.jsxDEV(s.Fragment,{children:[s.jsxDEV(Z,{},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:145,columnNumber:7},this),s.jsxDEV("div",{className:"flex flex-1 flex-col",children:s.jsxDEV("div",{className:"@container/main flex flex-1 flex-col gap-2",children:[s.jsxDEV(X,{icon:J,title:"Seasons Management",description:"Manage league seasons and tournaments",children:[s.jsxDEV(se,{className:"grid gap-4 grid-cols-2 md:grid-cols-4",children:[s.jsxDEV(N,{children:s.jsxDEV(D,{title:"Total Seasons",value:L,description:`${O} currently active`,icon:Q,iconColor:"text-primary",loading:m,error:h,onRetry:l},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:151,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:150,columnNumber:13},this),s.jsxDEV(N,{children:s.jsxDEV(D,{title:"Total Participants",value:U,description:"Across all seasons",icon:G,iconColor:"text-blue-500",loading:m,error:h,onRetry:l},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:154,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:153,columnNumber:13},this),s.jsxDEV(N,{children:s.jsxDEV(D,{title:"Total Revenue",value:`RM ${z.toLocaleString("en-MY",{minimumFractionDigits:2,maximumFractionDigits:2})}`,description:"From all season entry fees",icon:le,iconColor:"text-green-500",loading:m,error:h,onRetry:l},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:157,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:156,columnNumber:13},this),s.jsxDEV(N,{children:s.jsxDEV(D,{title:"Average per Season",value:B,description:"Players per season",icon:ie,iconColor:"text-yellow-500",loading:m,error:h,onRetry:l},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:163,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:162,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:149,columnNumber:11},this),s.jsxDEV(te,{children:s.jsxDEV("div",{className:"flex items-center gap-2 w-full",children:[s.jsxDEV(ne,{value:b,onChange:E,placeholder:"Search seasons...",className:"w-[220px]"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:170,columnNumber:15},this),s.jsxDEV(I,{value:v,onChange:S,options:ce,allLabel:"All Sports",triggerClassName:"w-[140px]"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:171,columnNumber:15},this),j.length>0&&s.jsxDEV(I,{value:w,onChange:_,options:j,allLabel:"All Leagues",triggerClassName:"w-[180px]"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:172,columnNumber:44},this),F&&s.jsxDEV(y,{variant:"ghost",size:"sm",onClick:P,className:"text-muted-foreground hover:text-foreground cursor-pointer",children:"Clear all"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:173,columnNumber:36},this),s.jsxDEV("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxDEV(y,{variant:"outline",size:"sm",onClick:M,className:"cursor-pointer",children:[s.jsxDEV(oe,{className:"mr-2 size-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:178,columnNumber:19},this),"Export"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:177,columnNumber:17},this),s.jsxDEV(y,{variant:"outline",size:"sm",onClick:l,className:"cursor-pointer",children:[s.jsxDEV(W,{className:"mr-2 size-4"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:182,columnNumber:19},this),"Refresh"]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:181,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:176,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:169,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:168,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:148,columnNumber:11},this),s.jsxDEV(ae,{delay:.2,children:s.jsxDEV("div",{className:"flex-1 px-4 lg:px-6 pb-6",children:s.jsxDEV(c.Suspense,{fallback:s.jsxDEV("div",{className:"h-96 animate-pulse bg-muted rounded-lg"},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:192,columnNumber:33},this),children:s.jsxDEV(de,{data:u,isLoading:m,onViewSeason:T,onRefresh:l,searchQuery:b,sportFilter:v,leagueFilter:w},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:193,columnNumber:15},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:192,columnNumber:13},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:191,columnNumber:11},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:190,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:147,columnNumber:9},this)},void 0,!1,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:146,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/willywong/DeuceLeague/DL Admin/dl-admin/src/routes/_authenticated/seasons/index.tsx?tsr-split=component",lineNumber:144,columnNumber:10},this)}export{Ee as component};
